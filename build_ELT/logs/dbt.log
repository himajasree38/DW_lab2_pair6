[0m10:06:45.764341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025d5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c65700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052cd340>]}


============================== 10:06:45.767750 | c43e8a33-c9c3-4414-bae4-9548dab51877 ==============================
[0m10:06:45.767750 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:06:45.768120 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'printer_width': '80', 'log_format': 'default', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'target_path': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'profiles_dir': '/Users/himajasree/.dbt', 'write_json': 'True', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None'}
[0m10:06:47.338876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c43e8a33-c9c3-4414-bae4-9548dab51877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125ea6660>]}
[0m10:06:47.368862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c43e8a33-c9c3-4414-bae4-9548dab51877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1259057f0>]}
[0m10:06:47.369682 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:06:47.473929 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:06:47.474786 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:06:47.475090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c43e8a33-c9c3-4414-bae4-9548dab51877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123112cf0>]}
[0m10:06:48.192663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c43e8a33-c9c3-4414-bae4-9548dab51877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262f37d0>]}
[0m10:06:48.260643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c43e8a33-c9c3-4414-bae4-9548dab51877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126aa49b0>]}
[0m10:06:48.261029 [info ] [MainThread]: Found 2 models, 4 data tests, 459 macros
[0m10:06:48.261224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c43e8a33-c9c3-4414-bae4-9548dab51877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126588230>]}
[0m10:06:48.262354 [info ] [MainThread]: 
[0m10:06:48.262760 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:06:48.265274 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m10:06:48.370067 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m10:06:48.370485 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m10:06:48.370668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:49.442386 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.070 seconds
[0m10:06:49.448945 [debug] [ThreadPool]: On list_stock_db: Close
[0m10:06:49.595706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db_analytics'
[0m10:06:49.603900 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m10:06:49.604242 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m10:06:49.604460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:50.067933 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.463 seconds
[0m10:06:50.075758 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m10:06:50.226870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c43e8a33-c9c3-4414-bae4-9548dab51877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12680ad80>]}
[0m10:06:50.229513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:06:50.230469 [info ] [MainThread]: 
[0m10:06:50.239413 [debug] [Thread-1 (]: Began running node model.build_ELT.my_first_dbt_model
[0m10:06:50.241427 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m10:06:50.242884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now model.build_ELT.my_first_dbt_model)
[0m10:06:50.243566 [debug] [Thread-1 (]: Began compiling node model.build_ELT.my_first_dbt_model
[0m10:06:50.256344 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.my_first_dbt_model"
[0m10:06:50.257427 [debug] [Thread-1 (]: Began executing node model.build_ELT.my_first_dbt_model
[0m10:06:50.296431 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.my_first_dbt_model"
[0m10:06:50.298491 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.my_first_dbt_model"
[0m10:06:50.299073 [debug] [Thread-1 (]: On model.build_ELT.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.my_first_dbt_model"} */
create or replace transient table stock_db.analytics.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:06:50.299716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:06:51.969336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.668 seconds
[0m10:06:52.019106 [debug] [Thread-1 (]: On model.build_ELT.my_first_dbt_model: Close
[0m10:06:52.217827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c43e8a33-c9c3-4414-bae4-9548dab51877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126204a70>]}
[0m10:06:52.221723 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.my_first_dbt_model ................. [[32mSUCCESS 1[0m in 1.97s]
[0m10:06:52.225245 [debug] [Thread-1 (]: Finished running node model.build_ELT.my_first_dbt_model
[0m10:06:52.229448 [debug] [Thread-1 (]: Began running node model.build_ELT.my_second_dbt_model
[0m10:06:52.230550 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m10:06:52.231573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.my_first_dbt_model, now model.build_ELT.my_second_dbt_model)
[0m10:06:52.232401 [debug] [Thread-1 (]: Began compiling node model.build_ELT.my_second_dbt_model
[0m10:06:52.239217 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.my_second_dbt_model"
[0m10:06:52.240262 [debug] [Thread-1 (]: Began executing node model.build_ELT.my_second_dbt_model
[0m10:06:52.273810 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.my_second_dbt_model"
[0m10:06:52.276037 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.my_second_dbt_model"
[0m10:06:52.276721 [debug] [Thread-1 (]: On model.build_ELT.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.my_second_dbt_model"} */
create or replace   view stock_db.analytics.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from stock_db.analytics.my_first_dbt_model
where id = 1
  );
[0m10:06:52.277373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:06:52.852191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m10:06:52.868179 [debug] [Thread-1 (]: On model.build_ELT.my_second_dbt_model: Close
[0m10:06:53.021952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c43e8a33-c9c3-4414-bae4-9548dab51877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527eed0>]}
[0m10:06:53.022936 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.my_second_dbt_model ................. [[32mSUCCESS 1[0m in 0.79s]
[0m10:06:53.024031 [debug] [Thread-1 (]: Finished running node model.build_ELT.my_second_dbt_model
[0m10:06:53.027535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:06:53.028086 [debug] [MainThread]: Connection 'list_stock_db' was properly closed.
[0m10:06:53.028270 [debug] [MainThread]: Connection 'model.build_ELT.my_second_dbt_model' was properly closed.
[0m10:06:53.028532 [info ] [MainThread]: 
[0m10:06:53.028911 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.77 seconds (4.77s).
[0m10:06:53.031204 [debug] [MainThread]: Command end result
[0m10:06:53.122569 [info ] [MainThread]: 
[0m10:06:53.123544 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:06:53.123786 [info ] [MainThread]: 
[0m10:06:53.124155 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:06:53.129519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.409116, "process_user_time": 3.677314, "process_kernel_time": 1.562011, "process_mem_max_rss": "182812672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:06:53.131210 [debug] [MainThread]: Command `dbt run` succeeded at 10:06:53.131090 after 7.41 seconds
[0m10:06:53.132194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d13620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126cb2e40>]}
[0m10:06:53.132554 [debug] [MainThread]: Flushing usage events
[0m10:11:45.765744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080399a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b01760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b013a0>]}


============================== 10:11:45.768203 | 3600c39d-5284-4006-a76a-f6ed2ef9b3a6 ==============================
[0m10:11:45.768203 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:11:45.768564 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'profiles_dir': '/Users/himajasree/.dbt', 'invocation_command': 'dbt run', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'printer_width': '80', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False'}
[0m10:11:47.015618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3600c39d-5284-4006-a76a-f6ed2ef9b3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c6fa960>]}
[0m10:11:47.040575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3600c39d-5284-4006-a76a-f6ed2ef9b3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795cf20>]}
[0m10:11:47.041230 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:11:47.109210 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:11:47.316872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:11:47.317264 [debug] [MainThread]: Partial parsing: added file: build_ELT://models/output/stock_metrics.sql
[0m10:11:47.317442 [debug] [MainThread]: Partial parsing: added file: build_ELT://models/input/stock_prices.sql
[0m10:11:47.394632 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.build_ELT.stock_prices' (models/input/stock_prices.sql) depends on a source named 'raw_data.stock_prices' which was not found
[0m10:11:47.397051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6765966, "process_user_time": 2.47506, "process_kernel_time": 1.407712, "process_mem_max_rss": "184500224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:11:47.397364 [debug] [MainThread]: Command `dbt run` failed at 10:11:47.397313 after 1.68 seconds
[0m10:11:47.397580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b01520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d2f5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129d54a40>]}
[0m10:11:47.397765 [debug] [MainThread]: Flushing usage events
[0m10:16:42.005648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094557f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109455430>]}


============================== 10:16:42.009211 | 99d9ac5b-b660-486d-966b-87fbca89691d ==============================
[0m10:16:42.009211 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:16:42.009606 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'empty': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'invocation_command': 'dbt run', 'write_json': 'True', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/himajasree/.dbt', 'log_format': 'default', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'cache_selected_only': 'False', 'printer_width': '80', 'target_path': 'None', 'log_cache_events': 'False', 'fail_fast': 'False'}
[0m10:16:43.217539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99d9ac5b-b660-486d-966b-87fbca89691d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12adc8b60>]}
[0m10:16:43.242338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99d9ac5b-b660-486d-966b-87fbca89691d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a25d0>]}
[0m10:16:43.243048 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:16:43.310177 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:16:43.570112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m10:16:43.570506 [debug] [MainThread]: Partial parsing: added file: build_ELT://models/input/sources.yml
[0m10:16:43.570695 [debug] [MainThread]: Partial parsing: added file: build_ELT://models/input/stock_prices.sql
[0m10:16:43.570844 [debug] [MainThread]: Partial parsing: added file: build_ELT://models/output/stock_metrics.sql
[0m10:16:43.732134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99d9ac5b-b660-486d-966b-87fbca89691d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7dca0>]}
[0m10:16:43.790561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99d9ac5b-b660-486d-966b-87fbca89691d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f27f3e0>]}
[0m10:16:43.790870 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 459 macros
[0m10:16:43.791062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d9ac5b-b660-486d-966b-87fbca89691d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e5a80e0>]}
[0m10:16:43.792049 [info ] [MainThread]: 
[0m10:16:43.792367 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:16:43.794591 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m10:16:43.801401 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m10:16:43.801598 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m10:16:43.801742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:44.434165 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.632 seconds
[0m10:16:44.437270 [debug] [ThreadPool]: On list_stock_db: Close
[0m10:16:44.564294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics)
[0m10:16:44.573411 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m10:16:44.573668 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m10:16:44.573815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:45.008644 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.434 seconds
[0m10:16:45.013012 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m10:16:45.147213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d9ac5b-b660-486d-966b-87fbca89691d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e7fb110>]}
[0m10:16:45.148265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:16:45.148864 [info ] [MainThread]: 
[0m10:16:45.151919 [debug] [Thread-1 (]: Began running node model.build_ELT.my_first_dbt_model
[0m10:16:45.152341 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m10:16:45.152610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now model.build_ELT.my_first_dbt_model)
[0m10:16:45.152795 [debug] [Thread-1 (]: Began compiling node model.build_ELT.my_first_dbt_model
[0m10:16:45.157206 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.my_first_dbt_model"
[0m10:16:45.157805 [debug] [Thread-1 (]: Began executing node model.build_ELT.my_first_dbt_model
[0m10:16:45.172423 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.my_first_dbt_model"
[0m10:16:45.173066 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.my_first_dbt_model"
[0m10:16:45.173266 [debug] [Thread-1 (]: On model.build_ELT.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.my_first_dbt_model"} */
create or replace transient table stock_db.analytics.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:16:45.173440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:46.270897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.097 seconds
[0m10:16:46.287627 [debug] [Thread-1 (]: On model.build_ELT.my_first_dbt_model: Close
[0m10:16:46.427404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99d9ac5b-b660-486d-966b-87fbca89691d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f1940>]}
[0m10:16:46.428585 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.my_first_dbt_model ................. [[32mSUCCESS 1[0m in 1.27s]
[0m10:16:46.429474 [debug] [Thread-1 (]: Finished running node model.build_ELT.my_first_dbt_model
[0m10:16:46.430026 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m10:16:46.430310 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stock_prices ............................. [RUN]
[0m10:16:46.430691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.my_first_dbt_model, now model.build_ELT.stock_prices)
[0m10:16:46.430940 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m10:16:46.432803 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m10:16:46.433421 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m10:16:46.443908 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m10:16:46.444499 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m10:16:46.444694 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics.stock_prices
  
   as (
    # Query: 
# ContextLines: 1

SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m10:16:46.444856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:46.929163 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85ee8-0004-2f06-0002-1feb0004921a
[0m10:16:46.929540 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected '# '.
[0m10:16:46.929842 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m10:16:47.097826 [debug] [Thread-1 (]: Database Error in model stock_prices (models/input/stock_prices.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected '# '.
  compiled code at target/run/build_ELT/models/input/stock_prices.sql
[0m10:16:47.098371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99d9ac5b-b660-486d-966b-87fbca89691d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f5459d0>]}
[0m10:16:47.098791 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model analytics.stock_prices .................... [[31mERROR[0m in 0.67s]
[0m10:16:47.099100 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m10:16:47.099334 [debug] [Thread-1 (]: Began running node model.build_ELT.my_second_dbt_model
[0m10:16:47.099535 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m10:16:47.100354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.my_second_dbt_model)
[0m10:16:47.100567 [debug] [Thread-1 (]: Began compiling node model.build_ELT.my_second_dbt_model
[0m10:16:47.102232 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.my_second_dbt_model"
[0m10:16:47.102647 [debug] [Thread-1 (]: Began executing node model.build_ELT.my_second_dbt_model
[0m10:16:47.103995 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.my_second_dbt_model"
[0m10:16:47.104457 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.my_second_dbt_model"
[0m10:16:47.104638 [debug] [Thread-1 (]: On model.build_ELT.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.my_second_dbt_model"} */
create or replace   view stock_db.analytics.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from stock_db.analytics.my_first_dbt_model
where id = 1
  );
[0m10:16:47.104796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:47.702477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m10:16:47.707416 [debug] [Thread-1 (]: On model.build_ELT.my_second_dbt_model: Close
[0m10:16:47.857000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99d9ac5b-b660-486d-966b-87fbca89691d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8213a0>]}
[0m10:16:47.858169 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.my_second_dbt_model ................. [[32mSUCCESS 1[0m in 0.76s]
[0m10:16:47.859111 [debug] [Thread-1 (]: Finished running node model.build_ELT.my_second_dbt_model
[0m10:16:47.859715 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_metrics
[0m10:16:47.860273 [info ] [Thread-1 (]: 4 of 4 SKIP relation analytics.stock_metrics ................................... [[33mSKIP[0m]
[0m10:16:47.860873 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_metrics
[0m10:16:47.861851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:47.862039 [debug] [MainThread]: Connection 'model.build_ELT.my_second_dbt_model' was properly closed.
[0m10:16:47.862261 [info ] [MainThread]: 
[0m10:16:47.862450 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m10:16:47.862925 [debug] [MainThread]: Command end result
[0m10:16:47.878547 [info ] [MainThread]: 
[0m10:16:47.878788 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:16:47.878950 [info ] [MainThread]: 
[0m10:16:47.879140 [error] [MainThread]:   Database Error in model stock_prices (models/input/stock_prices.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected '# '.
  compiled code at target/run/build_ELT/models/input/stock_prices.sql
[0m10:16:47.879289 [info ] [MainThread]: 
[0m10:16:47.879441 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m10:16:47.881937 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.9238186, "process_user_time": 2.788464, "process_kernel_time": 1.456272, "process_mem_max_rss": "188727296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:16:47.882299 [debug] [MainThread]: Command `dbt run` failed at 10:16:47.882252 after 5.92 seconds
[0m10:16:47.882510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e5fe720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094555b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109455700>]}
[0m10:16:47.882684 [debug] [MainThread]: Flushing usage events
[0m10:20:41.464438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134fff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11449d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11449d310>]}


============================== 10:20:41.466734 | fe21b900-1478-464f-b0de-a157972e665a ==============================
[0m10:20:41.466734 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:20:41.467120 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'debug': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'profiles_dir': '/Users/himajasree/.dbt', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'introspect': 'True'}
[0m10:20:42.680937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe21b900-1478-464f-b0de-a157972e665a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145893800>]}
[0m10:20:42.705680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe21b900-1478-464f-b0de-a157972e665a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144c0530>]}
[0m10:20:42.706429 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:20:42.773811 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:20:42.865807 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m10:20:42.866180 [debug] [MainThread]: Partial parsing: deleted file: build_ELT://models/example/my_second_dbt_model.sql
[0m10:20:42.866336 [debug] [MainThread]: Partial parsing: deleted file: build_ELT://models/example/my_first_dbt_model.sql
[0m10:20:42.902283 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.example
[0m10:20:42.908368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe21b900-1478-464f-b0de-a157972e665a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147926270>]}
[0m10:20:42.957277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe21b900-1478-464f-b0de-a157972e665a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d889e0>]}
[0m10:20:42.957587 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m10:20:42.957762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe21b900-1478-464f-b0de-a157972e665a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b38800>]}
[0m10:20:42.958620 [info ] [MainThread]: 
[0m10:20:42.958931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:20:42.961097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m10:20:42.968698 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m10:20:42.968896 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m10:20:42.969049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:43.583664 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.614 seconds
[0m10:20:43.586948 [debug] [ThreadPool]: On list_stock_db: Close
[0m10:20:43.728373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics)
[0m10:20:43.733592 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m10:20:43.733800 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m10:20:43.733952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:44.186635 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.452 seconds
[0m10:20:44.190295 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m10:20:44.328976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe21b900-1478-464f-b0de-a157972e665a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147828b30>]}
[0m10:20:44.329843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:20:44.330331 [info ] [MainThread]: 
[0m10:20:44.333240 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m10:20:44.334018 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stock_prices ............................. [RUN]
[0m10:20:44.334672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now model.build_ELT.stock_prices)
[0m10:20:44.335513 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m10:20:44.339583 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m10:20:44.340067 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m10:20:44.354167 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m10:20:44.354718 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m10:20:44.354907 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics.stock_prices
  
   as (
    # Query: 
# ContextLines: 1

SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m10:20:44.355069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:44.827008 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85eec-0004-2f4f-0002-1feb0004a29a
[0m10:20:44.827345 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected '# '.
[0m10:20:44.827606 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m10:20:44.970184 [debug] [Thread-1 (]: Database Error in model stock_prices (models/input/stock_prices.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected '# '.
  compiled code at target/run/build_ELT/models/input/stock_prices.sql
[0m10:20:44.971298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe21b900-1478-464f-b0de-a157972e665a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147f5e1e0>]}
[0m10:20:44.971706 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model analytics.stock_prices .................... [[31mERROR[0m in 0.64s]
[0m10:20:44.972024 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m10:20:44.972808 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_metrics
[0m10:20:44.973081 [info ] [Thread-1 (]: 2 of 2 SKIP relation analytics.stock_metrics ................................... [[33mSKIP[0m]
[0m10:20:44.973327 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_metrics
[0m10:20:44.973894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:44.974049 [debug] [MainThread]: Connection 'model.build_ELT.stock_prices' was properly closed.
[0m10:20:44.974230 [info ] [MainThread]: 
[0m10:20:44.974390 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m10:20:44.974719 [debug] [MainThread]: Command end result
[0m10:20:44.992101 [info ] [MainThread]: 
[0m10:20:44.992343 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:20:44.992500 [info ] [MainThread]: 
[0m10:20:44.992681 [error] [MainThread]:   Database Error in model stock_prices (models/input/stock_prices.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected '# '.
  compiled code at target/run/build_ELT/models/input/stock_prices.sql
[0m10:20:44.992829 [info ] [MainThread]: 
[0m10:20:44.992977 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m10:20:44.995410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5722234, "process_user_time": 2.600834, "process_kernel_time": 1.430138, "process_mem_max_rss": "191234048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:20:44.995722 [debug] [MainThread]: Command `dbt run` failed at 10:20:44.995676 after 3.57 seconds
[0m10:20:44.995974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113610110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1478b73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11449d400>]}
[0m10:20:44.996161 [debug] [MainThread]: Flushing usage events
[0m10:22:18.981632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c41730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770d400>]}


============================== 10:22:18.984191 | 7d54ec21-4748-4863-9fc3-1dad50a1341d ==============================
[0m10:22:18.984191 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:22:18.984591 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/himajasree/.dbt', 'quiet': 'False', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'partial_parse': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs'}
[0m10:22:19.881087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d54ec21-4748-4863-9fc3-1dad50a1341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b3fbfb0>]}
[0m10:22:19.906333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d54ec21-4748-4863-9fc3-1dad50a1341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12af66c90>]}
[0m10:22:19.907038 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:22:19.976989 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:22:20.069927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:22:20.070406 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/input/stock_prices.sql
[0m10:22:20.191153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.example
[0m10:22:20.198155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d54ec21-4748-4863-9fc3-1dad50a1341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c6b0530>]}
[0m10:22:20.244986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d54ec21-4748-4863-9fc3-1dad50a1341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3abb00>]}
[0m10:22:20.245308 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m10:22:20.245485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d54ec21-4748-4863-9fc3-1dad50a1341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c27aa20>]}
[0m10:22:20.246350 [info ] [MainThread]: 
[0m10:22:20.246651 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:22:20.249029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m10:22:20.255669 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m10:22:20.255874 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m10:22:20.256030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:20.896098 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.640 seconds
[0m10:22:20.899672 [debug] [ThreadPool]: On list_stock_db: Close
[0m10:22:21.031736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics)
[0m10:22:21.040062 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m10:22:21.040378 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m10:22:21.040532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:21.788003 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.747 seconds
[0m10:22:21.792020 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m10:22:21.938865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d54ec21-4748-4863-9fc3-1dad50a1341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c677020>]}
[0m10:22:21.940197 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:22:21.940843 [info ] [MainThread]: 
[0m10:22:21.942736 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m10:22:21.943057 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stock_prices ............................. [RUN]
[0m10:22:21.943313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now model.build_ELT.stock_prices)
[0m10:22:21.943524 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m10:22:21.947498 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m10:22:21.948104 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m10:22:21.961744 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m10:22:21.962261 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m10:22:21.962449 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m10:22:21.962610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:22.698627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m10:22:22.713953 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m10:22:22.840526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d54ec21-4748-4863-9fc3-1dad50a1341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c11ca40>]}
[0m10:22:22.841675 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.90s]
[0m10:22:22.842630 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m10:22:22.843833 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_metrics
[0m10:22:22.844543 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.stock_metrics ............................ [RUN]
[0m10:22:22.845180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_metrics)
[0m10:22:22.845666 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_metrics
[0m10:22:22.847494 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_metrics"
[0m10:22:22.848202 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_metrics
[0m10:22:22.849599 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_metrics"
[0m10:22:22.851279 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_metrics"
[0m10:22:22.851496 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_metrics"} */
create or replace   view stock_db.analytics.stock_metrics
  
   as (
    # Query: 
# ContextLines: 1

WITH stock_data AS (
    SELECT * FROM stock_db.analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                 THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END)
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS gain,
        ABS(SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                     THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END))
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        "close",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date",
    ma."symbol",
    ma.moving_avg_7d,
    rsi.rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m10:22:22.851705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:23.280231 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85eee-0004-2f4f-0002-1feb0004a29e
[0m10:22:23.280532 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected '# '.
syntax error line 9 at position 1 unexpected ','.
[0m10:22:23.280776 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: Close
[0m10:22:23.420873 [debug] [Thread-1 (]: Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected '# '.
  syntax error line 9 at position 1 unexpected ','.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m10:22:23.421334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d54ec21-4748-4863-9fc3-1dad50a1341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d064a70>]}
[0m10:22:23.421753 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics.stock_metrics ................... [[31mERROR[0m in 0.58s]
[0m10:22:23.422095 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_metrics
[0m10:22:23.423353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:23.423532 [debug] [MainThread]: Connection 'model.build_ELT.stock_metrics' was properly closed.
[0m10:22:23.423759 [info ] [MainThread]: 
[0m10:22:23.423930 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m10:22:23.424344 [debug] [MainThread]: Command end result
[0m10:22:23.442285 [info ] [MainThread]: 
[0m10:22:23.442621 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:22:23.442780 [info ] [MainThread]: 
[0m10:22:23.442975 [error] [MainThread]:   Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected '# '.
  syntax error line 9 at position 1 unexpected ','.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m10:22:23.443253 [info ] [MainThread]: 
[0m10:22:23.443400 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m10:22:23.447181 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.5042057, "process_user_time": 2.511485, "process_kernel_time": 1.117488, "process_mem_max_rss": "186761216", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:22:23.447897 [debug] [MainThread]: Command `dbt run` failed at 10:22:23.447844 after 4.51 seconds
[0m10:22:23.448262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c6b7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770d4f0>]}
[0m10:22:23.448432 [debug] [MainThread]: Flushing usage events
[0m10:24:01.824843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107329940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107329550>]}


============================== 10:24:01.830416 | 70ab2635-1760-4593-84d2-e919c475eba9 ==============================
[0m10:24:01.830416 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:24:01.830826 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '/Users/himajasree/.dbt', 'debug': 'False', 'introspect': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'empty': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'partial_parse': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'no_print': 'None'}
[0m10:24:02.976565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70ab2635-1760-4593-84d2-e919c475eba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9e32c0>]}
[0m10:24:03.001161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70ab2635-1760-4593-84d2-e919c475eba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9b5550>]}
[0m10:24:03.001804 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:24:03.067441 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:24:03.149413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:24:03.149786 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/output/stock_metrics.sql
[0m10:24:03.262275 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.example
[0m10:24:03.269465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70ab2635-1760-4593-84d2-e919c475eba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe868d0>]}
[0m10:24:03.317813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70ab2635-1760-4593-84d2-e919c475eba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12029aea0>]}
[0m10:24:03.318126 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m10:24:03.318305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70ab2635-1760-4593-84d2-e919c475eba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe858e0>]}
[0m10:24:03.319250 [info ] [MainThread]: 
[0m10:24:03.319550 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:24:03.322143 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m10:24:03.328736 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m10:24:03.328940 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m10:24:03.329088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:03.932167 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.602 seconds
[0m10:24:03.935164 [debug] [ThreadPool]: On list_stock_db: Close
[0m10:24:04.068578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics)
[0m10:24:04.075700 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m10:24:04.075981 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m10:24:04.076127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:04.603670 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.527 seconds
[0m10:24:04.606595 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m10:24:04.761035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70ab2635-1760-4593-84d2-e919c475eba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd40a40>]}
[0m10:24:04.761975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:04.762450 [info ] [MainThread]: 
[0m10:24:04.764733 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m10:24:04.765100 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stock_prices ............................. [RUN]
[0m10:24:04.765362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now model.build_ELT.stock_prices)
[0m10:24:04.765538 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m10:24:04.769481 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m10:24:04.770169 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m10:24:04.784279 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m10:24:04.785194 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m10:24:04.785396 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m10:24:04.785561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:05.559340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m10:24:05.576801 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m10:24:05.746222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ab2635-1760-4593-84d2-e919c475eba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd0c620>]}
[0m10:24:05.747429 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.98s]
[0m10:24:05.748291 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m10:24:05.748764 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_metrics
[0m10:24:05.749030 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.stock_metrics ............................ [RUN]
[0m10:24:05.749354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_metrics)
[0m10:24:05.749734 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_metrics
[0m10:24:05.751283 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_metrics"
[0m10:24:05.752048 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_metrics
[0m10:24:05.753666 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_metrics"
[0m10:24:05.754713 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_metrics"
[0m10:24:05.754929 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_metrics"} */
create or replace   view stock_db.analytics.stock_metrics
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                 THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END)
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS gain,
        ABS(SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                     THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END))
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date",
    ma."symbol",
    ma.moving_avg_7d,
    rsi.rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m10:24:05.755148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:06.162817 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85ef0-0004-2f06-0002-1feb0004925a
[0m10:24:06.163147 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 53 at position 56 unexpected ';'.
[0m10:24:06.163403 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: Close
[0m10:24:06.341420 [debug] [Thread-1 (]: Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m10:24:06.341778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ab2635-1760-4593-84d2-e919c475eba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120516b40>]}
[0m10:24:06.342113 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics.stock_metrics ................... [[31mERROR[0m in 0.59s]
[0m10:24:06.342402 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_metrics
[0m10:24:06.343384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:06.343570 [debug] [MainThread]: Connection 'model.build_ELT.stock_metrics' was properly closed.
[0m10:24:06.343750 [info ] [MainThread]: 
[0m10:24:06.343911 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m10:24:06.344271 [debug] [MainThread]: Command end result
[0m10:24:06.359445 [info ] [MainThread]: 
[0m10:24:06.359670 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:24:06.359815 [info ] [MainThread]: 
[0m10:24:06.359988 [error] [MainThread]:   Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m10:24:06.360130 [info ] [MainThread]: 
[0m10:24:06.360280 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m10:24:06.362454 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.5790334, "process_user_time": 2.84011, "process_kernel_time": 1.032841, "process_mem_max_rss": "201457664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:24:06.362777 [debug] [MainThread]: Command `dbt run` failed at 10:24:06.362729 after 4.58 seconds
[0m10:24:06.362982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107329280>]}
[0m10:24:06.363177 [debug] [MainThread]: Flushing usage events
[0m10:26:07.997994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101110d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110159850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110159490>]}


============================== 10:26:08.000520 | 3ed3ce88-41d9-419b-ba90-5a75cb337dc7 ==============================
[0m10:26:08.000520 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:26:08.000870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'version_check': 'True', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/himajasree/.dbt', 'partial_parse': 'True', 'write_json': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'target_path': 'None', 'debug': 'False'}
[0m10:26:09.295766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ed3ce88-41d9-419b-ba90-5a75cb337dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063efb60>]}
[0m10:26:09.320642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ed3ce88-41d9-419b-ba90-5a75cb337dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101843e0>]}
[0m10:26:09.321317 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:26:09.386379 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:26:09.490911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:26:09.491377 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/output/stock_metrics.sql
[0m10:26:09.617306 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.example
[0m10:26:09.623895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ed3ce88-41d9-419b-ba90-5a75cb337dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dfb0200>]}
[0m10:26:09.677256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ed3ce88-41d9-419b-ba90-5a75cb337dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dcae660>]}
[0m10:26:09.677591 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m10:26:09.677771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ed3ce88-41d9-419b-ba90-5a75cb337dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126074d40>]}
[0m10:26:09.678678 [info ] [MainThread]: 
[0m10:26:09.679039 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:26:09.682126 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m10:26:09.689833 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m10:26:09.690112 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m10:26:09.690307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:10.507698 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.817 seconds
[0m10:26:10.511158 [debug] [ThreadPool]: On list_stock_db: Close
[0m10:26:10.670018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics)
[0m10:26:10.678154 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m10:26:10.678408 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m10:26:10.678556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:11.238215 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.559 seconds
[0m10:26:11.241945 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m10:26:11.460153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ed3ce88-41d9-419b-ba90-5a75cb337dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14de63170>]}
[0m10:26:11.461337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:11.461826 [info ] [MainThread]: 
[0m10:26:11.464647 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m10:26:11.465021 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stock_prices ............................. [RUN]
[0m10:26:11.465287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now model.build_ELT.stock_prices)
[0m10:26:11.465463 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m10:26:11.469501 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m10:26:11.470201 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m10:26:11.484235 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m10:26:11.484935 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m10:26:11.485124 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m10:26:11.485286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:12.226584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m10:26:12.242584 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m10:26:12.376321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ed3ce88-41d9-419b-ba90-5a75cb337dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d928500>]}
[0m10:26:12.377576 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.91s]
[0m10:26:12.378464 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m10:26:12.379098 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_metrics
[0m10:26:12.379394 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.stock_metrics ............................ [RUN]
[0m10:26:12.379677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_metrics)
[0m10:26:12.379869 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_metrics
[0m10:26:12.381576 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_metrics"
[0m10:26:12.383025 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_metrics
[0m10:26:12.384514 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_metrics"
[0m10:26:12.385560 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_metrics"
[0m10:26:12.385780 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_metrics"} */
create or replace   view stock_db.analytics.stock_metrics
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                 THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END)
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS gain,
        ABS(SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                     THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END))
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date",
    ma."symbol",
    ma.moving_avg_7d,
    rsi.rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol"
;
[0m10:26:12.385975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:12.802021 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85ef2-0004-2f4f-0002-1feb0004a2ae
[0m10:26:12.802309 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 0 unexpected ';'.
[0m10:26:12.802549 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: Close
[0m10:26:12.958939 [debug] [Thread-1 (]: Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 0 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m10:26:12.959274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ed3ce88-41d9-419b-ba90-5a75cb337dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e23da60>]}
[0m10:26:12.959625 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics.stock_metrics ................... [[31mERROR[0m in 0.58s]
[0m10:26:12.959925 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_metrics
[0m10:26:12.960900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:12.961050 [debug] [MainThread]: Connection 'model.build_ELT.stock_metrics' was properly closed.
[0m10:26:12.961220 [info ] [MainThread]: 
[0m10:26:12.961373 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m10:26:12.961746 [debug] [MainThread]: Command end result
[0m10:26:12.976936 [info ] [MainThread]: 
[0m10:26:12.977165 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:26:12.977315 [info ] [MainThread]: 
[0m10:26:12.977493 [error] [MainThread]:   Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 0 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m10:26:12.977651 [info ] [MainThread]: 
[0m10:26:12.977802 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m10:26:12.980055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.023394, "process_user_time": 2.649369, "process_kernel_time": 1.45086, "process_mem_max_rss": "191823872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:26:12.980369 [debug] [MainThread]: Command `dbt run` failed at 10:26:12.980323 after 5.02 seconds
[0m10:26:12.980568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079db770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d928500>]}
[0m10:26:12.980740 [debug] [MainThread]: Flushing usage events
[0m10:30:30.736443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e4fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a259580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a259190>]}


============================== 10:30:30.739417 | 7161c86e-8413-40f4-abaa-3840b7411a12 ==============================
[0m10:30:30.739417 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:30:30.739773 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'warn_error': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'profiles_dir': '/Users/himajasree/.dbt', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'empty': 'False', 'introspect': 'True', 'use_colors': 'True'}
[0m10:30:31.936919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7161c86e-8413-40f4-abaa-3840b7411a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a207230>]}
[0m10:30:31.965987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7161c86e-8413-40f4-abaa-3840b7411a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a284410>]}
[0m10:30:31.966870 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:30:32.044881 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:30:32.127876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:30:32.128262 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/output/stock_metrics.sql
[0m10:30:32.236316 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.example
[0m10:30:32.242747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7161c86e-8413-40f4-abaa-3840b7411a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1500b7fe0>]}
[0m10:30:32.298904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7161c86e-8413-40f4-abaa-3840b7411a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147caa990>]}
[0m10:30:32.299230 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m10:30:32.299423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7161c86e-8413-40f4-abaa-3840b7411a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15007ef00>]}
[0m10:30:32.300371 [info ] [MainThread]: 
[0m10:30:32.300685 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:30:32.303133 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m10:30:32.319446 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m10:30:32.319660 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m10:30:32.319822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:32.981581 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.661 seconds
[0m10:30:32.985941 [debug] [ThreadPool]: On list_stock_db: Close
[0m10:30:33.130527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics)
[0m10:30:33.139937 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m10:30:33.140178 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m10:30:33.140328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:33.600404 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.460 seconds
[0m10:30:33.613492 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m10:30:33.754001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7161c86e-8413-40f4-abaa-3840b7411a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1478b7050>]}
[0m10:30:33.754862 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:30:33.755344 [info ] [MainThread]: 
[0m10:30:33.758095 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m10:30:33.758844 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stock_prices ............................. [RUN]
[0m10:30:33.759413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now model.build_ELT.stock_prices)
[0m10:30:33.759758 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m10:30:33.764854 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m10:30:33.765439 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m10:30:33.787663 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m10:30:33.788494 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m10:30:33.788757 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m10:30:33.788987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:34.473645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m10:30:34.491197 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m10:30:34.614818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7161c86e-8413-40f4-abaa-3840b7411a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14781ce30>]}
[0m10:30:34.616228 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.85s]
[0m10:30:34.617400 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m10:30:34.618323 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_metrics
[0m10:30:34.618621 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.stock_metrics ............................ [RUN]
[0m10:30:34.618919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_metrics)
[0m10:30:34.619132 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_metrics
[0m10:30:34.621062 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_metrics"
[0m10:30:34.621686 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_metrics
[0m10:30:34.623242 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_metrics"
[0m10:30:34.624279 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_metrics"
[0m10:30:34.624499 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_metrics"} */
create or replace   view stock_db.analytics.stock_metrics
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                 THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END)
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS gain,
        ABS(SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                     THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END))
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m10:30:34.624706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:35.075912 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85ef6-0004-2f06-0002-1feb0004932e
[0m10:30:35.076195 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 53 at position 56 unexpected ';'.
[0m10:30:35.076434 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: Close
[0m10:30:35.222867 [debug] [Thread-1 (]: Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m10:30:35.223225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7161c86e-8413-40f4-abaa-3840b7411a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15032eab0>]}
[0m10:30:35.223576 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics.stock_metrics ................... [[31mERROR[0m in 0.60s]
[0m10:30:35.223890 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_metrics
[0m10:30:35.225472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:35.225668 [debug] [MainThread]: Connection 'model.build_ELT.stock_metrics' was properly closed.
[0m10:30:35.225879 [info ] [MainThread]: 
[0m10:30:35.226050 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.93 seconds (2.93s).
[0m10:30:35.226467 [debug] [MainThread]: Command end result
[0m10:30:35.245631 [info ] [MainThread]: 
[0m10:30:35.245904 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:30:35.246063 [info ] [MainThread]: 
[0m10:30:35.246246 [error] [MainThread]:   Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m10:30:35.246396 [info ] [MainThread]: 
[0m10:30:35.246552 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m10:30:35.249365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.5624404, "process_user_time": 2.469388, "process_kernel_time": 1.595761, "process_mem_max_rss": "190513152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:30:35.249735 [debug] [MainThread]: Command `dbt run` failed at 10:30:35.249683 after 4.56 seconds
[0m10:30:35.249965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cefb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107286b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a204bf0>]}
[0m10:30:35.250149 [debug] [MainThread]: Flushing usage events
[0m10:35:14.379704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113c0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115859970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115859580>]}


============================== 10:35:14.382409 | ac4b2145-21c8-4093-90f8-9ac484b039d3 ==============================
[0m10:35:14.382409 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:35:14.382796 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'printer_width': '80', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'empty': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'profiles_dir': '/Users/himajasree/.dbt', 'cache_selected_only': 'False', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False'}
[0m10:35:15.725513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac4b2145-21c8-4093-90f8-9ac484b039d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115884770>]}
[0m10:35:15.749991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac4b2145-21c8-4093-90f8-9ac484b039d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11585b380>]}
[0m10:35:15.750641 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:35:15.817389 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:35:15.871055 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:35:15.871388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac4b2145-21c8-4093-90f8-9ac484b039d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16849f260>]}
[0m10:35:16.526649 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m10:35:16.531791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac4b2145-21c8-4093-90f8-9ac484b039d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16863bd40>]}
[0m10:35:16.590029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac4b2145-21c8-4093-90f8-9ac484b039d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1686a6fc0>]}
[0m10:35:16.591012 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m10:35:16.591272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac4b2145-21c8-4093-90f8-9ac484b039d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154fca570>]}
[0m10:35:16.592712 [info ] [MainThread]: 
[0m10:35:16.593370 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:35:16.597360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m10:35:16.613744 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m10:35:16.614440 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m10:35:16.614731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:17.345605 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.731 seconds
[0m10:35:17.348210 [debug] [ThreadPool]: On list_stock_db: Close
[0m10:35:17.474953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now create_stock_db_analytics_analytics)
[0m10:35:17.476239 [debug] [ThreadPool]: Creating schema "database: "stock_db"
schema: "analytics_analytics"
"
[0m10:35:17.481355 [debug] [ThreadPool]: Using snowflake connection "create_stock_db_analytics_analytics"
[0m10:35:17.481610 [debug] [ThreadPool]: On create_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "create_stock_db_analytics_analytics"} */
create schema if not exists stock_db.analytics_analytics
[0m10:35:17.481760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:18.117085 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.635 seconds
[0m10:35:18.119704 [debug] [ThreadPool]: On create_stock_db_analytics_analytics: Close
[0m10:35:18.249184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_stock_db_analytics_analytics, now list_stock_db_analytics_analytics)
[0m10:35:18.256136 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m10:35:18.256386 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m10:35:18.256534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:18.835387 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.579 seconds
[0m10:35:18.838773 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m10:35:18.997591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac4b2145-21c8-4093-90f8-9ac484b039d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b0b080>]}
[0m10:35:18.998869 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:35:18.999486 [info ] [MainThread]: 
[0m10:35:19.003154 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m10:35:19.003500 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_analytics.stock_prices ................... [RUN]
[0m10:35:19.003762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m10:35:19.003934 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m10:35:19.008533 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m10:35:19.009044 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m10:35:19.023030 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m10:35:19.023575 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m10:35:19.023764 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics_analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m10:35:19.023928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:19.873823 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m10:35:19.889381 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m10:35:20.024214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac4b2145-21c8-4093-90f8-9ac484b039d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b39a00>]}
[0m10:35:20.025688 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_analytics.stock_prices .............. [[32mSUCCESS 1[0m in 1.02s]
[0m10:35:20.026747 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m10:35:20.027786 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_metrics
[0m10:35:20.028215 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics_analytics.stock_metrics .................. [RUN]
[0m10:35:20.028489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_metrics)
[0m10:35:20.028691 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_metrics
[0m10:35:20.030597 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_metrics"
[0m10:35:20.031153 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_metrics
[0m10:35:20.032535 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_metrics"
[0m10:35:20.033607 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_metrics"
[0m10:35:20.033828 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_metrics"} */
create or replace   view stock_db.analytics_analytics.stock_metrics
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                 THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END)
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS gain,
        ABS(SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                     THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END))
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m10:35:20.034043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:20.420456 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85efb-0004-2f06-0002-1feb0004933e
[0m10:35:20.420742 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 53 at position 56 unexpected ';'.
[0m10:35:20.420987 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: Close
[0m10:35:20.613609 [debug] [Thread-1 (]: Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m10:35:20.613971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac4b2145-21c8-4093-90f8-9ac484b039d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16801f350>]}
[0m10:35:20.614301 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics_analytics.stock_metrics ......... [[31mERROR[0m in 0.59s]
[0m10:35:20.614595 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_metrics
[0m10:35:20.615837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:20.616040 [debug] [MainThread]: Connection 'model.build_ELT.stock_metrics' was properly closed.
[0m10:35:20.616244 [info ] [MainThread]: 
[0m10:35:20.616418 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m10:35:20.616827 [debug] [MainThread]: Command end result
[0m10:35:20.632066 [info ] [MainThread]: 
[0m10:35:20.632315 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:35:20.632474 [info ] [MainThread]: 
[0m10:35:20.632663 [error] [MainThread]:   Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m10:35:20.632820 [info ] [MainThread]: 
[0m10:35:20.632980 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m10:35:20.635284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.2984405, "process_user_time": 3.471008, "process_kernel_time": 1.273233, "process_mem_max_rss": "190857216", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:35:20.635578 [debug] [MainThread]: Command `dbt run` failed at 10:35:20.635535 after 6.30 seconds
[0m10:35:20.635770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16867cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b39a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16897e5d0>]}
[0m10:35:20.635931 [debug] [MainThread]: Flushing usage events
[0m11:06:29.091040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4b0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c159730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c159310>]}


============================== 11:06:29.093770 | 183ab66d-0aab-48f8-b9ca-d5c44188278b ==============================
[0m11:06:29.093770 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:06:29.094130 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'log_format': 'default', 'introspect': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'version_check': 'True', 'no_print': 'None', 'quiet': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'write_json': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'warn_error': 'None', 'printer_width': '80', 'partial_parse': 'True', 'empty': 'False'}
[0m11:06:29.097650 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m11:06:29.099548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.06090025, "process_user_time": 0.698907, "process_kernel_time": 0.13053, "process_mem_max_rss": "96206848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:06:29.099960 [debug] [MainThread]: Command `dbt run` failed at 11:06:29.099899 after 0.06 seconds
[0m11:06:29.100164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1595b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109729340>]}
[0m11:06:29.100556 [debug] [MainThread]: Flushing usage events
[0m11:18:16.713899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108156840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4d3a0>]}


============================== 11:18:16.716478 | 6b71f6eb-b6b7-4c07-bdd4-f8b9d6cdf77e ==============================
[0m11:18:16.716478 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:18:16.716836 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'use_colors': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'quiet': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m11:18:16.719900 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m11:18:16.721711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.049669042, "process_user_time": 0.626541, "process_kernel_time": 0.114423, "process_mem_max_rss": "102481920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:18:16.722040 [debug] [MainThread]: Command `dbt run` failed at 11:18:16.721988 after 0.05 seconds
[0m11:18:16.722217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4d430>]}
[0m11:18:16.722581 [debug] [MainThread]: Flushing usage events
[0m11:18:51.571737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e39310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a616a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a612e0>]}


============================== 11:18:51.575944 | 73282600-6a88-4e12-98a5-be45f055c29f ==============================
[0m11:18:51.575944 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:18:51.576402 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'version_check': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'write_json': 'True', 'profiles_dir': '/Users/himajasree/.dbt', 'indirect_selection': 'eager', 'introspect': 'True', 'quiet': 'False'}
[0m11:18:52.766259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73282600-6a88-4e12-98a5-be45f055c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131c5b8c0>]}
[0m11:18:52.790823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73282600-6a88-4e12-98a5-be45f055c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1314cdb80>]}
[0m11:18:52.791526 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:18:52.859785 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:18:53.045090 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m11:18:53.045481 [debug] [MainThread]: Partial parsing: added file: build_ELT://models/sources.yml
[0m11:18:53.045676 [debug] [MainThread]: Partial parsing: added file: build_ELT://models/schema.yml
[0m11:18:53.178884 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:18:53.179247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '73282600-6a88-4e12-98a5-be45f055c29f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b9bb00>]}
[0m11:18:53.275437 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m11:18:53.285843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73282600-6a88-4e12-98a5-be45f055c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13413eae0>]}
[0m11:18:53.348870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73282600-6a88-4e12-98a5-be45f055c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1341b7980>]}
[0m11:18:53.349238 [info ] [MainThread]: Found 2 models, 5 data tests, 1 source, 459 macros
[0m11:18:53.349442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73282600-6a88-4e12-98a5-be45f055c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131d56f90>]}
[0m11:18:53.350487 [info ] [MainThread]: 
[0m11:18:53.350820 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:18:53.353141 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m11:18:53.360562 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m11:18:53.360806 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m11:18:53.360967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:54.037497 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.676 seconds
[0m11:18:54.040904 [debug] [ThreadPool]: On list_stock_db: Close
[0m11:18:54.187010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m11:18:54.194343 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m11:18:54.194590 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:18:54.194745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:54.673389 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.478 seconds
[0m11:18:54.677268 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m11:18:54.806162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73282600-6a88-4e12-98a5-be45f055c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1343797c0>]}
[0m11:18:54.807059 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:18:54.807498 [info ] [MainThread]: 
[0m11:18:54.810412 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m11:18:54.810809 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_analytics.stock_prices ................... [RUN]
[0m11:18:54.811083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m11:18:54.811277 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m11:18:54.816158 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m11:18:54.817027 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m11:18:54.832024 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m11:18:54.832745 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m11:18:54.832955 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics_analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m11:18:54.833131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:55.658254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.825 seconds
[0m11:18:55.674972 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m11:18:55.807273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73282600-6a88-4e12-98a5-be45f055c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1343be2d0>]}
[0m11:18:55.808509 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_analytics.stock_prices .............. [[32mSUCCESS 1[0m in 0.99s]
[0m11:18:55.809489 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m11:18:55.810536 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_metrics
[0m11:18:55.811136 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics_analytics.stock_metrics .................. [RUN]
[0m11:18:55.811480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_metrics)
[0m11:18:55.811698 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_metrics
[0m11:18:55.813425 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_metrics"
[0m11:18:55.813988 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_metrics
[0m11:18:55.815488 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_metrics"
[0m11:18:55.816539 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_metrics"
[0m11:18:55.816754 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_metrics"} */
create or replace   view stock_db.analytics_analytics.stock_metrics
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                 THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END)
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS gain,
        ABS(SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                     THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END))
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m11:18:55.816950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:56.256077 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f26-0004-2f06-0002-1feb0004934e
[0m11:18:56.256402 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 53 at position 56 unexpected ';'.
[0m11:18:56.256646 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: Close
[0m11:18:56.432590 [debug] [Thread-1 (]: Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m11:18:56.432940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73282600-6a88-4e12-98a5-be45f055c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134542a80>]}
[0m11:18:56.433282 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics_analytics.stock_metrics ......... [[31mERROR[0m in 0.62s]
[0m11:18:56.433582 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_metrics
[0m11:18:56.434666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:56.435054 [debug] [MainThread]: Connection 'model.build_ELT.stock_metrics' was properly closed.
[0m11:18:56.435283 [info ] [MainThread]: 
[0m11:18:56.435464 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m11:18:56.435935 [debug] [MainThread]: Command end result
[0m11:18:56.496259 [info ] [MainThread]: 
[0m11:18:56.496539 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:18:56.496696 [info ] [MainThread]: 
[0m11:18:56.496884 [error] [MainThread]:   Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m11:18:56.497029 [info ] [MainThread]: 
[0m11:18:56.497181 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:18:56.498789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.9670935, "process_user_time": 3.2268, "process_kernel_time": 0.824404, "process_mem_max_rss": "196460544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:18:56.499063 [debug] [MainThread]: Command `dbt run` failed at 11:18:56.499019 after 4.97 seconds
[0m11:18:56.499251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310e83b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062db6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106310110>]}
[0m11:18:56.499419 [debug] [MainThread]: Flushing usage events
[0m11:23:14.332997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a172030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a170320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a191640>]}


============================== 11:23:14.345255 | 8b543abe-7df0-43a2-876f-4c511ded9582 ==============================
[0m11:23:14.345255 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:23:14.352992 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'empty': 'False', 'profiles_dir': '/Users/himajasree/.dbt', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'log_format': 'default', 'static_parser': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt compile', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m11:23:15.944016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b543abe-7df0-43a2-876f-4c511ded9582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c9e6570>]}
[0m11:23:15.969340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b543abe-7df0-43a2-876f-4c511ded9582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c6830b0>]}
[0m11:23:15.969984 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:23:16.043088 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:23:16.136194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:16.136463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:16.139105 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m11:23:16.156517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b543abe-7df0-43a2-876f-4c511ded9582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c9e4320>]}
[0m11:23:16.243999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b543abe-7df0-43a2-876f-4c511ded9582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12caa0770>]}
[0m11:23:16.244337 [info ] [MainThread]: Found 2 models, 5 data tests, 1 source, 459 macros
[0m11:23:16.244516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b543abe-7df0-43a2-876f-4c511ded9582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c706540>]}
[0m11:23:16.245530 [info ] [MainThread]: 
[0m11:23:16.245852 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:23:16.247915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db_analytics_analytics'
[0m11:23:16.256403 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m11:23:16.256600 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:23:16.256747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:16.799315 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.542 seconds
[0m11:23:16.803146 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m11:23:16.942160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b543abe-7df0-43a2-876f-4c511ded9582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c706540>]}
[0m11:23:16.943401 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:16.944126 [info ] [MainThread]: 
[0m11:23:16.948114 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m11:23:16.948916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m11:23:16.949216 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m11:23:16.957707 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m11:23:16.960387 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m11:23:16.961377 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m11:23:16.962109 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_metrics
[0m11:23:16.962363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_metrics)
[0m11:23:16.962560 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_metrics
[0m11:23:16.967574 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_metrics"
[0m11:23:16.968620 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_metrics
[0m11:23:16.969072 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_metrics
[0m11:23:16.969949 [debug] [Thread-1 (]: Began running node test.build_ELT.not_null_stock_metrics_date.c2fdbd617e
[0m11:23:16.970813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_metrics, now test.build_ELT.not_null_stock_metrics_date.c2fdbd617e)
[0m11:23:16.971738 [debug] [Thread-1 (]: Began compiling node test.build_ELT.not_null_stock_metrics_date.c2fdbd617e
[0m11:23:16.980209 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_ELT.not_null_stock_metrics_date.c2fdbd617e"
[0m11:23:16.982334 [debug] [Thread-1 (]: Began executing node test.build_ELT.not_null_stock_metrics_date.c2fdbd617e
[0m11:23:16.983256 [debug] [Thread-1 (]: Finished running node test.build_ELT.not_null_stock_metrics_date.c2fdbd617e
[0m11:23:16.983563 [debug] [Thread-1 (]: Began running node test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336
[0m11:23:16.984334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_ELT.not_null_stock_metrics_date.c2fdbd617e, now test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336)
[0m11:23:16.984751 [debug] [Thread-1 (]: Began compiling node test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336
[0m11:23:16.989430 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336"
[0m11:23:16.990055 [debug] [Thread-1 (]: Began executing node test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336
[0m11:23:16.990453 [debug] [Thread-1 (]: Finished running node test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336
[0m11:23:16.990684 [debug] [Thread-1 (]: Began running node test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171
[0m11:23:16.990979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336, now test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171)
[0m11:23:16.991178 [debug] [Thread-1 (]: Began compiling node test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171
[0m11:23:16.994857 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171"
[0m11:23:16.995609 [debug] [Thread-1 (]: Began executing node test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171
[0m11:23:16.996428 [debug] [Thread-1 (]: Finished running node test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171
[0m11:23:16.996694 [debug] [Thread-1 (]: Began running node test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7
[0m11:23:16.996982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171, now test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7)
[0m11:23:16.997195 [debug] [Thread-1 (]: Began compiling node test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7
[0m11:23:16.999676 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7"
[0m11:23:17.000252 [debug] [Thread-1 (]: Began executing node test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7
[0m11:23:17.000642 [debug] [Thread-1 (]: Finished running node test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7
[0m11:23:17.000867 [debug] [Thread-1 (]: Began running node test.build_ELT.unique_stock_metrics_date.a7f1c68ed1
[0m11:23:17.001284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7, now test.build_ELT.unique_stock_metrics_date.a7f1c68ed1)
[0m11:23:17.001540 [debug] [Thread-1 (]: Began compiling node test.build_ELT.unique_stock_metrics_date.a7f1c68ed1
[0m11:23:17.005504 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_ELT.unique_stock_metrics_date.a7f1c68ed1"
[0m11:23:17.006158 [debug] [Thread-1 (]: Began executing node test.build_ELT.unique_stock_metrics_date.a7f1c68ed1
[0m11:23:17.006593 [debug] [Thread-1 (]: Finished running node test.build_ELT.unique_stock_metrics_date.a7f1c68ed1
[0m11:23:17.007728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:17.007963 [debug] [MainThread]: Connection 'test.build_ELT.unique_stock_metrics_date.a7f1c68ed1' was properly closed.
[0m11:23:17.008694 [debug] [MainThread]: Command end result
[0m11:23:17.042887 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.763521, "process_user_time": 2.908583, "process_kernel_time": 1.023173, "process_mem_max_rss": "179421184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:17.044268 [debug] [MainThread]: Command `dbt compile` succeeded at 11:23:17.044033 after 2.76 seconds
[0m11:23:17.045136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099db770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cc13fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1919d0>]}
[0m11:23:17.045422 [debug] [MainThread]: Flushing usage events
[0m11:30:46.712883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107245850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107245460>]}


============================== 11:30:46.716288 | d029529f-eae1-4ef3-9b59-73adef15e891 ==============================
[0m11:30:46.716288 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:30:46.716662 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'version_check': 'True', 'fail_fast': 'False', 'empty': 'False', 'warn_error': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'debug': 'False', 'invocation_command': 'dbt compile', 'introspect': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None'}
[0m11:30:47.946390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd029529f-eae1-4ef3-9b59-73adef15e891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a4b60>]}
[0m11:30:47.970863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd029529f-eae1-4ef3-9b59-73adef15e891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8c1310>]}
[0m11:30:47.971481 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:30:48.040226 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:30:48.102904 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:30:48.103233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd029529f-eae1-4ef3-9b59-73adef15e891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ec4a0>]}
[0m11:30:48.676864 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:30:48.677389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd029529f-eae1-4ef3-9b59-73adef15e891', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ffc8740>]}
[0m11:30:48.846940 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m11:30:48.852333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd029529f-eae1-4ef3-9b59-73adef15e891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12010efc0>]}
[0m11:30:48.905841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd029529f-eae1-4ef3-9b59-73adef15e891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff83740>]}
[0m11:30:48.906154 [info ] [MainThread]: Found 2 models, 5 data tests, 1 source, 459 macros
[0m11:30:48.906336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd029529f-eae1-4ef3-9b59-73adef15e891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff62f60>]}
[0m11:30:48.907248 [info ] [MainThread]: 
[0m11:30:48.907543 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:30:48.909644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db_analytics_analytics'
[0m11:30:48.917427 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m11:30:48.917652 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:30:48.917800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:50.689776 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:30:50.690025 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:30:50.690230 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:30:50.690365 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:30:50.690523 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: No close available on handle
[0m11:30:50.690912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:50.691097 [debug] [MainThread]: Connection 'list_stock_db_analytics_analytics' was properly closed.
[0m11:30:50.691340 [error] [MainThread]: Encountered an error:
Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
  Verify that the hostnames and port numbers in SYSTEM$ALLOWLIST are added to your firewall's allowed list.
  To further troubleshoot your connection you may reference the following article: https://docs.snowflake.com/en/user-guide/client-connectivity-troubleshooting/overview.
[0m11:30:50.693809 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 4.0255923, "process_user_time": 3.232303, "process_kernel_time": 1.301215, "process_mem_max_rss": "195264512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:30:50.694088 [debug] [MainThread]: Command `dbt compile` failed at 11:30:50.694046 after 4.03 seconds
[0m11:30:50.694259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107245850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120382c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120381ac0>]}
[0m11:30:50.694433 [debug] [MainThread]: Flushing usage events
[0m11:31:23.825886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ce6f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf99af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf99700>]}


============================== 11:31:23.829831 | 6d1ab9bd-56f4-4919-a989-5b4870f1df0f ==============================
[0m11:31:23.829831 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:31:23.830211 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'empty': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'static_parser': 'True', 'warn_error': 'None', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'indirect_selection': 'eager', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False'}
[0m11:31:24.760851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d1ab9bd-56f4-4919-a989-5b4870f1df0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf4a540>]}
[0m11:31:24.785870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d1ab9bd-56f4-4919-a989-5b4870f1df0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aab4b90>]}
[0m11:31:24.786614 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:31:24.858734 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:31:24.920363 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:31:24.920714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d1ab9bd-56f4-4919-a989-5b4870f1df0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4386e0>]}
[0m11:31:25.365101 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:31:25.365443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6d1ab9bd-56f4-4919-a989-5b4870f1df0f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12de15ca0>]}
[0m11:31:25.533166 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m11:31:25.538487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d1ab9bd-56f4-4919-a989-5b4870f1df0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e3f6030>]}
[0m11:31:25.604984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d1ab9bd-56f4-4919-a989-5b4870f1df0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e28a2a0>]}
[0m11:31:25.605285 [info ] [MainThread]: Found 2 models, 5 data tests, 1 source, 459 macros
[0m11:31:25.605465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d1ab9bd-56f4-4919-a989-5b4870f1df0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e0d7980>]}
[0m11:31:25.606407 [info ] [MainThread]: 
[0m11:31:25.606697 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:31:25.608804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db_analytics_analytics'
[0m11:31:25.616636 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m11:31:25.616837 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:31:25.616985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:26.272151 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.655 seconds
[0m11:31:26.275904 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m11:31:26.426867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d1ab9bd-56f4-4919-a989-5b4870f1df0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1cd370>]}
[0m11:31:26.427998 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:31:26.428634 [info ] [MainThread]: 
[0m11:31:26.432108 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m11:31:26.432547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m11:31:26.432753 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m11:31:26.436925 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m11:31:26.437941 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m11:31:26.438304 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m11:31:26.438682 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_metrics
[0m11:31:26.438915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_metrics)
[0m11:31:26.439093 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_metrics
[0m11:31:26.440529 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_metrics"
[0m11:31:26.440882 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_metrics
[0m11:31:26.441193 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_metrics
[0m11:31:26.441511 [debug] [Thread-1 (]: Began running node test.build_ELT.not_null_stock_metrics_date.c2fdbd617e
[0m11:31:26.441694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_metrics, now test.build_ELT.not_null_stock_metrics_date.c2fdbd617e)
[0m11:31:26.441854 [debug] [Thread-1 (]: Began compiling node test.build_ELT.not_null_stock_metrics_date.c2fdbd617e
[0m11:31:26.447453 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_ELT.not_null_stock_metrics_date.c2fdbd617e"
[0m11:31:26.447824 [debug] [Thread-1 (]: Began executing node test.build_ELT.not_null_stock_metrics_date.c2fdbd617e
[0m11:31:26.448132 [debug] [Thread-1 (]: Finished running node test.build_ELT.not_null_stock_metrics_date.c2fdbd617e
[0m11:31:26.448314 [debug] [Thread-1 (]: Began running node test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336
[0m11:31:26.448498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_ELT.not_null_stock_metrics_date.c2fdbd617e, now test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336)
[0m11:31:26.448656 [debug] [Thread-1 (]: Began compiling node test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336
[0m11:31:26.450477 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336"
[0m11:31:26.450791 [debug] [Thread-1 (]: Began executing node test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336
[0m11:31:26.451089 [debug] [Thread-1 (]: Finished running node test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336
[0m11:31:26.451275 [debug] [Thread-1 (]: Began running node test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171
[0m11:31:26.451459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336, now test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171)
[0m11:31:26.451641 [debug] [Thread-1 (]: Began compiling node test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171
[0m11:31:26.453493 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171"
[0m11:31:26.453847 [debug] [Thread-1 (]: Began executing node test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171
[0m11:31:26.454144 [debug] [Thread-1 (]: Finished running node test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171
[0m11:31:26.454324 [debug] [Thread-1 (]: Began running node test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7
[0m11:31:26.454503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171, now test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7)
[0m11:31:26.454658 [debug] [Thread-1 (]: Began compiling node test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7
[0m11:31:26.457185 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7"
[0m11:31:26.457514 [debug] [Thread-1 (]: Began executing node test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7
[0m11:31:26.457816 [debug] [Thread-1 (]: Finished running node test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7
[0m11:31:26.458032 [debug] [Thread-1 (]: Began running node test.build_ELT.unique_stock_metrics_date.a7f1c68ed1
[0m11:31:26.458219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7, now test.build_ELT.unique_stock_metrics_date.a7f1c68ed1)
[0m11:31:26.458384 [debug] [Thread-1 (]: Began compiling node test.build_ELT.unique_stock_metrics_date.a7f1c68ed1
[0m11:31:26.461263 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_ELT.unique_stock_metrics_date.a7f1c68ed1"
[0m11:31:26.461598 [debug] [Thread-1 (]: Began executing node test.build_ELT.unique_stock_metrics_date.a7f1c68ed1
[0m11:31:26.461896 [debug] [Thread-1 (]: Finished running node test.build_ELT.unique_stock_metrics_date.a7f1c68ed1
[0m11:31:26.462411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:26.462551 [debug] [MainThread]: Connection 'test.build_ELT.unique_stock_metrics_date.a7f1c68ed1' was properly closed.
[0m11:31:26.463125 [debug] [MainThread]: Command end result
[0m11:31:26.479968 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.6929722, "process_user_time": 2.872147, "process_kernel_time": 1.19423, "process_mem_max_rss": "190365696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:31:26.480291 [debug] [MainThread]: Command `dbt compile` succeeded at 11:31:26.480245 after 2.69 seconds
[0m11:31:26.480476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11be1d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa06e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd58740>]}
[0m11:31:26.480652 [debug] [MainThread]: Flushing usage events
[0m11:31:31.837179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10989d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10989d430>]}


============================== 11:31:31.839510 | f5230339-fb09-4373-9c4d-3646e31691e1 ==============================
[0m11:31:31.839510 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:31:31.839859 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'write_json': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'debug': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'empty': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80'}
[0m11:31:32.565388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5230339-fb09-4373-9c4d-3646e31691e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235fbfb0>]}
[0m11:31:32.589762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5230339-fb09-4373-9c4d-3646e31691e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092cb290>]}
[0m11:31:32.590440 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:31:32.664089 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:31:32.753443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:31:32.753720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:31:32.756488 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m11:31:32.779172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5230339-fb09-4373-9c4d-3646e31691e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238e72f0>]}
[0m11:31:32.832000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5230339-fb09-4373-9c4d-3646e31691e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d9d040>]}
[0m11:31:32.832338 [info ] [MainThread]: Found 2 models, 5 data tests, 1 source, 459 macros
[0m11:31:32.832528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5230339-fb09-4373-9c4d-3646e31691e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c117c0>]}
[0m11:31:32.833487 [info ] [MainThread]: 
[0m11:31:32.833796 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:31:32.835948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m11:31:32.843162 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m11:31:32.843349 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m11:31:32.843495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:33.328135 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.484 seconds
[0m11:31:33.331471 [debug] [ThreadPool]: On list_stock_db: Close
[0m11:31:33.511934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m11:31:33.520078 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m11:31:33.520335 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:31:33.520495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:31:34.104889 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.584 seconds
[0m11:31:34.108863 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m11:31:34.268857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5230339-fb09-4373-9c4d-3646e31691e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238e4b00>]}
[0m11:31:34.270092 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:31:34.270622 [info ] [MainThread]: 
[0m11:31:34.273260 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m11:31:34.273685 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_analytics.stock_prices ................... [RUN]
[0m11:31:34.273969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m11:31:34.274151 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m11:31:34.278243 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m11:31:34.278737 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m11:31:34.293400 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m11:31:34.294250 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m11:31:34.294442 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics_analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m11:31:34.294607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:35.275794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.981 seconds
[0m11:31:35.293712 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m11:31:35.432571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5230339-fb09-4373-9c4d-3646e31691e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e3dbe0>]}
[0m11:31:35.433724 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_analytics.stock_prices .............. [[32mSUCCESS 1[0m in 1.16s]
[0m11:31:35.434692 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m11:31:35.436270 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_metrics
[0m11:31:35.437084 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics_analytics.stock_metrics .................. [RUN]
[0m11:31:35.437705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_metrics)
[0m11:31:35.437930 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_metrics
[0m11:31:35.439514 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_metrics"
[0m11:31:35.439955 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_metrics
[0m11:31:35.441463 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_metrics"
[0m11:31:35.442729 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_metrics"
[0m11:31:35.442954 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_metrics"} */
create or replace   view stock_db.analytics_analytics.stock_metrics
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                 THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END)
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS gain,
        ABS(SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                     THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END))
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m11:31:35.443208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:35.987903 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f33-0004-2f4f-0002-1feb0004a38e
[0m11:31:35.988216 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 53 at position 56 unexpected ';'.
[0m11:31:35.988475 [debug] [Thread-1 (]: On model.build_ELT.stock_metrics: Close
[0m11:31:36.160465 [debug] [Thread-1 (]: Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m11:31:36.160832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5230339-fb09-4373-9c4d-3646e31691e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ffbe30>]}
[0m11:31:36.161188 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics_analytics.stock_metrics ......... [[31mERROR[0m in 0.72s]
[0m11:31:36.161497 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_metrics
[0m11:31:36.162474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:36.162660 [debug] [MainThread]: Connection 'model.build_ELT.stock_metrics' was properly closed.
[0m11:31:36.162852 [info ] [MainThread]: 
[0m11:31:36.163017 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m11:31:36.163401 [debug] [MainThread]: Command end result
[0m11:31:36.179061 [info ] [MainThread]: 
[0m11:31:36.179305 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:31:36.179459 [info ] [MainThread]: 
[0m11:31:36.179640 [error] [MainThread]:   Database Error in model stock_metrics (models/output/stock_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_metrics.sql
[0m11:31:36.179783 [info ] [MainThread]: 
[0m11:31:36.179942 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:31:36.181367 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.3747354, "process_user_time": 2.423314, "process_kernel_time": 1.00189, "process_mem_max_rss": "189087744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:31:36.181646 [debug] [MainThread]: Command `dbt run` failed at 11:31:36.181601 after 4.38 seconds
[0m11:31:36.181836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095bb170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ae990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092df890>]}
[0m11:31:36.181998 [debug] [MainThread]: Flushing usage events
[0m11:41:30.378285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e46f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a017c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a012b0>]}


============================== 11:41:30.381610 | fb215ecf-06c2-4231-a8ec-d4be599db052 ==============================
[0m11:41:30.381610 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:41:30.381968 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'debug': 'False', 'empty': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'no_print': 'None', 'introspect': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m11:41:31.591887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb215ecf-06c2-4231-a8ec-d4be599db052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089db920>]}
[0m11:41:31.621252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb215ecf-06c2-4231-a8ec-d4be599db052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d697380>]}
[0m11:41:31.622067 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:41:31.711161 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:41:31.820070 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:41:31.820502 [debug] [MainThread]: Partial parsing: added file: build_ELT://models/output/stock_calc.sql
[0m11:41:31.820714 [debug] [MainThread]: Partial parsing: deleted file: build_ELT://models/output/stock_metrics.sql
[0m11:41:31.971641 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:41:31.972091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb215ecf-06c2-4231-a8ec-d4be599db052', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c48e000>]}
[0m11:41:31.980445 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stock_metrics' in the 'models' section of file 'models/schema.yml'
[0m11:41:32.043718 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.not_null_stock_metrics_date.c2fdbd617e' (models/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m11:41:32.044156 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.unique_stock_metrics_date.a7f1c68ed1' (models/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m11:41:32.044370 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7' (models/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m11:41:32.044550 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336' (models/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m11:41:32.044824 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171' (models/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m11:41:32.105578 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m11:41:32.112863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb215ecf-06c2-4231-a8ec-d4be599db052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c499ca0>]}
[0m11:41:32.184012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb215ecf-06c2-4231-a8ec-d4be599db052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c5bbef0>]}
[0m11:41:32.184392 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m11:41:32.184591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb215ecf-06c2-4231-a8ec-d4be599db052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c403110>]}
[0m11:41:32.185813 [info ] [MainThread]: 
[0m11:41:32.186281 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:32.188875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m11:41:32.196545 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m11:41:32.196847 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m11:41:32.197022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:32.913725 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.716 seconds
[0m11:41:32.918135 [debug] [ThreadPool]: On list_stock_db: Close
[0m11:41:33.041467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m11:41:33.049376 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m11:41:33.049699 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:41:33.049867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:33.493349 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.443 seconds
[0m11:41:33.496138 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m11:41:33.634204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb215ecf-06c2-4231-a8ec-d4be599db052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c5bbfe0>]}
[0m11:41:33.635115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:33.635644 [info ] [MainThread]: 
[0m11:41:33.640415 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m11:41:33.641245 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_analytics.stock_prices ................... [RUN]
[0m11:41:33.641546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m11:41:33.641741 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m11:41:33.647036 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m11:41:33.647772 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m11:41:33.664382 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m11:41:33.665825 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m11:41:33.666229 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics_analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m11:41:33.666629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:34.628631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.962 seconds
[0m11:41:34.645640 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m11:41:34.789920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb215ecf-06c2-4231-a8ec-d4be599db052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d6948c0>]}
[0m11:41:34.790946 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_analytics.stock_prices .............. [[32mSUCCESS 1[0m in 1.15s]
[0m11:41:34.791775 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m11:41:34.792686 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calc
[0m11:41:34.793457 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics_analytics.stock_calc ..................... [RUN]
[0m11:41:34.794166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_calc)
[0m11:41:34.794482 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calc
[0m11:41:34.796324 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calc"
[0m11:41:34.796932 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calc
[0m11:41:34.799237 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calc"
[0m11:41:34.800366 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calc"
[0m11:41:34.800595 [debug] [Thread-1 (]: On model.build_ELT.stock_calc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calc"} */
create or replace   view stock_db.analytics_analytics.stock_calc
  
   as (
    # Query: 
# ContextLines: 1

WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                 THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END)
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS gain,
        ABS(SUM(CASE WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                     THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") ELSE 0 END))
        OVER (PARTITION BY "symbol" ORDER BY "date" ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m11:41:34.800802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:35.280834 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f3d-0004-2f4f-0002-1feb0004a396
[0m11:41:35.281187 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected '# '.
syntax error line 13 at position 1 unexpected ','.
[0m11:41:35.281507 [debug] [Thread-1 (]: On model.build_ELT.stock_calc: Close
[0m11:41:35.447584 [debug] [Thread-1 (]: Database Error in model stock_calc (models/output/stock_calc.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected '# '.
  syntax error line 13 at position 1 unexpected ','.
  compiled code at target/run/build_ELT/models/output/stock_calc.sql
[0m11:41:35.448027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb215ecf-06c2-4231-a8ec-d4be599db052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e3c0590>]}
[0m11:41:35.448401 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics_analytics.stock_calc ............ [[31mERROR[0m in 0.65s]
[0m11:41:35.448714 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calc
[0m11:41:35.449777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:35.449922 [debug] [MainThread]: Connection 'model.build_ELT.stock_calc' was properly closed.
[0m11:41:35.450089 [info ] [MainThread]: 
[0m11:41:35.450244 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m11:41:35.450598 [debug] [MainThread]: Command end result
[0m11:41:35.466647 [info ] [MainThread]: 
[0m11:41:35.466897 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:41:35.467059 [info ] [MainThread]: 
[0m11:41:35.467249 [error] [MainThread]:   Database Error in model stock_calc (models/output/stock_calc.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected '# '.
  syntax error line 13 at position 1 unexpected ','.
  compiled code at target/run/build_ELT/models/output/stock_calc.sql
[0m11:41:35.467401 [info ] [MainThread]: 
[0m11:41:35.467555 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:41:35.470071 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.135954, "process_user_time": 3.221579, "process_kernel_time": 1.070538, "process_mem_max_rss": "184877056", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:41:35.470400 [debug] [MainThread]: Command `dbt run` failed at 11:41:35.470359 after 5.14 seconds
[0m11:41:35.470606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c594ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a01550>]}
[0m11:41:35.470769 [debug] [MainThread]: Flushing usage events
[0m11:50:31.233367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109107dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e9310>]}


============================== 11:50:31.236241 | 37a51690-b42d-4f85-9e1c-e7da7470977e ==============================
[0m11:50:31.236241 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:50:31.236595 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'invocation_command': 'dbt run', 'version_check': 'True', 'empty': 'False', 'warn_error': 'None', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'no_print': 'None'}
[0m11:50:32.422177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37a51690-b42d-4f85-9e1c-e7da7470977e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f087fb0>]}
[0m11:50:32.446882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37a51690-b42d-4f85-9e1c-e7da7470977e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db4800>]}
[0m11:50:32.447516 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:50:32.513975 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:50:32.605929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:50:32.606317 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/output/stock_calc.sql
[0m11:50:32.716515 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m11:50:32.722453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37a51690-b42d-4f85-9e1c-e7da7470977e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f5c76b0>]}
[0m11:50:32.781471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37a51690-b42d-4f85-9e1c-e7da7470977e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f36cc50>]}
[0m11:50:32.781802 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m11:50:32.782016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37a51690-b42d-4f85-9e1c-e7da7470977e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f4bacf0>]}
[0m11:50:32.783009 [info ] [MainThread]: 
[0m11:50:32.783365 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:50:32.785643 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m11:50:32.792758 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m11:50:32.793009 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m11:50:32.793165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:33.737585 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.944 seconds
[0m11:50:33.741529 [debug] [ThreadPool]: On list_stock_db: Close
[0m11:50:33.890244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m11:50:33.898510 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m11:50:33.898827 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:50:33.899010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:34.560641 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.661 seconds
[0m11:50:34.563858 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m11:50:34.690935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37a51690-b42d-4f85-9e1c-e7da7470977e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5cf80>]}
[0m11:50:34.692049 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:50:34.692575 [info ] [MainThread]: 
[0m11:50:34.696203 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m11:50:34.696614 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_analytics.stock_prices ................... [RUN]
[0m11:50:34.696918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m11:50:34.697094 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m11:50:34.701153 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m11:50:34.701861 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m11:50:34.715883 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m11:50:34.716433 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m11:50:34.716621 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics_analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m11:50:34.716782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:35.432911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m11:50:35.449682 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m11:50:35.603689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a51690-b42d-4f85-9e1c-e7da7470977e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f02c2c0>]}
[0m11:50:35.604854 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_analytics.stock_prices .............. [[32mSUCCESS 1[0m in 0.90s]
[0m11:50:35.605672 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m11:50:35.606744 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calc
[0m11:50:35.607355 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics_analytics.stock_calc ..................... [RUN]
[0m11:50:35.607647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_calc)
[0m11:50:35.607849 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calc
[0m11:50:35.609525 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calc"
[0m11:50:35.610001 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calc
[0m11:50:35.611480 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calc"
[0m11:50:35.612576 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calc"
[0m11:50:35.612794 [debug] [Thread-1 (]: On model.build_ELT.stock_calc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calc"} */
create or replace   view stock_db.analytics_analytics.stock_calc
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        ABS(SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        )) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m11:50:35.613011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:36.021167 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f46-0004-2f4f-0002-1feb0004a39e
[0m11:50:36.021485 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 69 at position 56 unexpected ';'.
[0m11:50:36.021737 [debug] [Thread-1 (]: On model.build_ELT.stock_calc: Close
[0m11:50:36.164636 [debug] [Thread-1 (]: Database Error in model stock_calc (models/output/stock_calc.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_calc.sql
[0m11:50:36.165059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37a51690-b42d-4f85-9e1c-e7da7470977e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f963d10>]}
[0m11:50:36.165419 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics_analytics.stock_calc ............ [[31mERROR[0m in 0.56s]
[0m11:50:36.165737 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calc
[0m11:50:36.166837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:36.167026 [debug] [MainThread]: Connection 'model.build_ELT.stock_calc' was properly closed.
[0m11:50:36.167215 [info ] [MainThread]: 
[0m11:50:36.167377 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m11:50:36.167771 [debug] [MainThread]: Command end result
[0m11:50:36.184890 [info ] [MainThread]: 
[0m11:50:36.185154 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:50:36.185313 [info ] [MainThread]: 
[0m11:50:36.185507 [error] [MainThread]:   Database Error in model stock_calc (models/output/stock_calc.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_calc.sql
[0m11:50:36.185656 [info ] [MainThread]: 
[0m11:50:36.185810 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:50:36.188055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.995337, "process_user_time": 2.479176, "process_kernel_time": 1.672635, "process_mem_max_rss": "198524928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:50:36.188365 [debug] [MainThread]: Command `dbt run` failed at 11:50:36.188319 after 5.00 seconds
[0m11:50:36.188563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109394bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e2f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e9520>]}
[0m11:50:36.188731 [debug] [MainThread]: Flushing usage events
[0m11:51:39.549137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e34a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a819d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091195e0>]}


============================== 11:51:39.552578 | 89ab195a-3a06-498c-90d8-f4261fd28f84 ==============================
[0m11:51:39.552578 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:51:39.553013 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'use_colors': 'True', 'invocation_command': 'dbt run', 'empty': 'False', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False'}
[0m11:51:40.498862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89ab195a-3a06-498c-90d8-f4261fd28f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f74d40>]}
[0m11:51:40.524940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89ab195a-3a06-498c-90d8-f4261fd28f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdfbf0>]}
[0m11:51:40.525640 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:51:40.599541 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:51:40.696389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:40.696685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:40.699396 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m11:51:40.712649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89ab195a-3a06-498c-90d8-f4261fd28f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e29a2a0>]}
[0m11:51:40.782011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89ab195a-3a06-498c-90d8-f4261fd28f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e56c8c0>]}
[0m11:51:40.782343 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m11:51:40.782523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ab195a-3a06-498c-90d8-f4261fd28f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e66cb00>]}
[0m11:51:40.783426 [info ] [MainThread]: 
[0m11:51:40.783777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:40.786050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m11:51:40.793823 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m11:51:40.794090 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m11:51:40.794242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:41.313691 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.519 seconds
[0m11:51:41.316942 [debug] [ThreadPool]: On list_stock_db: Close
[0m11:51:41.454421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m11:51:41.463904 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m11:51:41.464173 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:51:41.464332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:42.014177 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.550 seconds
[0m11:51:42.019030 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m11:51:42.173246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ab195a-3a06-498c-90d8-f4261fd28f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d5e7740>]}
[0m11:51:42.174392 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:42.175036 [info ] [MainThread]: 
[0m11:51:42.178115 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m11:51:42.179031 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_analytics.stock_prices ................... [RUN]
[0m11:51:42.179429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m11:51:42.179629 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m11:51:42.183682 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m11:51:42.184388 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m11:51:42.198667 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m11:51:42.199253 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m11:51:42.199444 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics_analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m11:51:42.199609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:42.958449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m11:51:42.975298 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m11:51:43.114328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ab195a-3a06-498c-90d8-f4261fd28f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b9b50>]}
[0m11:51:43.115536 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_analytics.stock_prices .............. [[32mSUCCESS 1[0m in 0.93s]
[0m11:51:43.116442 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m11:51:43.117483 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calc
[0m11:51:43.118201 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics_analytics.stock_calc ..................... [RUN]
[0m11:51:43.118580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_calc)
[0m11:51:43.118780 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calc
[0m11:51:43.120475 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calc"
[0m11:51:43.120990 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calc
[0m11:51:43.122500 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calc"
[0m11:51:43.123574 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calc"
[0m11:51:43.123793 [debug] [Thread-1 (]: On model.build_ELT.stock_calc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calc"} */
create or replace   view stock_db.analytics_analytics.stock_calc
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        ABS(SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        )) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m11:51:43.124007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:43.602831 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f47-0004-2f06-0002-1feb0004936e
[0m11:51:43.603172 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 69 at position 56 unexpected ';'.
[0m11:51:43.603434 [debug] [Thread-1 (]: On model.build_ELT.stock_calc: Close
[0m11:51:43.728470 [debug] [Thread-1 (]: Database Error in model stock_calc (models/output/stock_calc.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_calc.sql
[0m11:51:43.728851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ab195a-3a06-498c-90d8-f4261fd28f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e927800>]}
[0m11:51:43.729185 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics_analytics.stock_calc ............ [[31mERROR[0m in 0.61s]
[0m11:51:43.729487 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calc
[0m11:51:43.730494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:43.730681 [debug] [MainThread]: Connection 'model.build_ELT.stock_calc' was properly closed.
[0m11:51:43.730863 [info ] [MainThread]: 
[0m11:51:43.731027 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m11:51:43.731410 [debug] [MainThread]: Command end result
[0m11:51:43.748899 [info ] [MainThread]: 
[0m11:51:43.749160 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:51:43.749318 [info ] [MainThread]: 
[0m11:51:43.749504 [error] [MainThread]:   Database Error in model stock_calc (models/output/stock_calc.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_calc.sql
[0m11:51:43.749652 [info ] [MainThread]: 
[0m11:51:43.749813 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:51:43.751250 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.244584, "process_user_time": 2.691101, "process_kernel_time": 0.772574, "process_mem_max_rss": "188284928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:51:43.751546 [debug] [MainThread]: Command `dbt run` failed at 11:51:43.751505 after 4.24 seconds
[0m11:51:43.751740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b882f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e59eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091195e0>]}
[0m11:51:43.751905 [debug] [MainThread]: Flushing usage events
[0m11:53:22.654116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb0aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109359850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109359460>]}


============================== 11:53:22.657164 | 9d2ffa67-4795-4810-aaca-fe5d5a60b1b3 ==============================
[0m11:53:22.657164 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:53:22.657549 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'no_print': 'None'}
[0m11:53:24.016730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d2ffa67-4795-4810-aaca-fe5d5a60b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14509e0f0>]}
[0m11:53:24.041526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d2ffa67-4795-4810-aaca-fe5d5a60b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a72bef0>]}
[0m11:53:24.042200 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:53:24.117658 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:53:24.211155 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:53:24.211531 [debug] [MainThread]: Partial parsing: added file: build_ELT://models/output/stock_calcs.sql
[0m11:53:24.211691 [debug] [MainThread]: Partial parsing: deleted file: build_ELT://models/output/stock_calc.sql
[0m11:53:24.324318 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m11:53:24.330616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d2ffa67-4795-4810-aaca-fe5d5a60b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1503c74d0>]}
[0m11:53:24.386601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d2ffa67-4795-4810-aaca-fe5d5a60b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145a22f30>]}
[0m11:53:24.387106 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m11:53:24.387342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d2ffa67-4795-4810-aaca-fe5d5a60b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150179b80>]}
[0m11:53:24.388580 [info ] [MainThread]: 
[0m11:53:24.388926 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:53:24.391273 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m11:53:24.397985 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m11:53:24.398186 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m11:53:24.398329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:25.019355 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.621 seconds
[0m11:53:25.022634 [debug] [ThreadPool]: On list_stock_db: Close
[0m11:53:25.149044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m11:53:25.158076 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m11:53:25.158400 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:53:25.158575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:25.730534 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.572 seconds
[0m11:53:25.735685 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m11:53:25.850545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d2ffa67-4795-4810-aaca-fe5d5a60b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cd1f0>]}
[0m11:53:25.851531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:53:25.851906 [info ] [MainThread]: 
[0m11:53:25.855585 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m11:53:25.856459 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_analytics.stock_prices ................... [RUN]
[0m11:53:25.856888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m11:53:25.857138 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m11:53:25.880752 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m11:53:25.882466 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m11:53:25.900470 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m11:53:25.901192 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m11:53:25.901413 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics_analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m11:53:25.901593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:26.590006 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m11:53:26.608356 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m11:53:26.738606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d2ffa67-4795-4810-aaca-fe5d5a60b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145790bc0>]}
[0m11:53:26.739933 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_analytics.stock_prices .............. [[32mSUCCESS 1[0m in 0.88s]
[0m11:53:26.741292 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m11:53:26.742540 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calcs
[0m11:53:26.742885 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics_analytics.stock_calcs .................... [RUN]
[0m11:53:26.743195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_calcs)
[0m11:53:26.743386 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calcs
[0m11:53:26.745391 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calcs"
[0m11:53:26.745862 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calcs
[0m11:53:26.747433 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calcs"
[0m11:53:26.749154 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calcs"
[0m11:53:26.749386 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calcs"} */
create or replace   view stock_db.analytics_analytics.stock_calcs
  
   as (
    # Query: 
# ContextLines: 1

WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        ABS(SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        )) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m11:53:26.749605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:27.221903 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f49-0004-2f06-0002-1feb00049376
[0m11:53:27.222234 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected '# '.
syntax error line 13 at position 1 unexpected ','.
[0m11:53:27.222513 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: Close
[0m11:53:27.354767 [debug] [Thread-1 (]: Database Error in model stock_calcs (models/output/stock_calcs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected '# '.
  syntax error line 13 at position 1 unexpected ','.
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m11:53:27.355302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d2ffa67-4795-4810-aaca-fe5d5a60b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145a6f7a0>]}
[0m11:53:27.355715 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics_analytics.stock_calcs ........... [[31mERROR[0m in 0.61s]
[0m11:53:27.356056 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calcs
[0m11:53:27.357296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:27.357506 [debug] [MainThread]: Connection 'model.build_ELT.stock_calcs' was properly closed.
[0m11:53:27.357742 [info ] [MainThread]: 
[0m11:53:27.357927 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m11:53:27.358349 [debug] [MainThread]: Command end result
[0m11:53:27.383580 [info ] [MainThread]: 
[0m11:53:27.383963 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:53:27.384231 [info ] [MainThread]: 
[0m11:53:27.384463 [error] [MainThread]:   Database Error in model stock_calcs (models/output/stock_calcs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected '# '.
  syntax error line 13 at position 1 unexpected ','.
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m11:53:27.384634 [info ] [MainThread]: 
[0m11:53:27.384800 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:53:27.387570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.7729115, "process_user_time": 2.980285, "process_kernel_time": 1.147631, "process_mem_max_rss": "188465152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:53:27.388502 [debug] [MainThread]: Command `dbt run` failed at 11:53:27.388444 after 4.77 seconds
[0m11:53:27.388778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdb9e0>]}
[0m11:53:27.388970 [debug] [MainThread]: Flushing usage events
[0m11:54:11.734617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109841730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109841310>]}


============================== 11:54:11.739778 | de6ccea2-5a8f-4837-b2f4-dc718d30b530 ==============================
[0m11:54:11.739778 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:54:11.740160 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select stock_calcs', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'quiet': 'False', 'fail_fast': 'False', 'introspect': 'True'}
[0m11:54:12.868649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de6ccea2-5a8f-4837-b2f4-dc718d30b530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dc7bec0>]}
[0m11:54:12.895227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de6ccea2-5a8f-4837-b2f4-dc718d30b530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920c800>]}
[0m11:54:12.896343 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:54:12.963630 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:54:13.054814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:54:13.055193 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/output/stock_calcs.sql
[0m11:54:13.166958 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m11:54:13.173207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de6ccea2-5a8f-4837-b2f4-dc718d30b530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125fc77d0>]}
[0m11:54:13.227105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de6ccea2-5a8f-4837-b2f4-dc718d30b530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125bf0b00>]}
[0m11:54:13.227415 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m11:54:13.227589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de6ccea2-5a8f-4837-b2f4-dc718d30b530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f840e0>]}
[0m11:54:13.228331 [info ] [MainThread]: 
[0m11:54:13.228629 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:54:13.229085 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m11:54:13.235738 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m11:54:13.235925 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m11:54:13.236073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:13.792973 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.557 seconds
[0m11:54:13.796046 [debug] [ThreadPool]: On list_stock_db: Close
[0m11:54:13.930270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m11:54:13.935186 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m11:54:13.935378 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:54:13.935522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:14.420279 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.485 seconds
[0m11:54:14.423673 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m11:54:14.547964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de6ccea2-5a8f-4837-b2f4-dc718d30b530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125bf0200>]}
[0m11:54:14.548968 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:54:14.549518 [info ] [MainThread]: 
[0m11:54:14.552842 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calcs
[0m11:54:14.553203 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_analytics.stock_calcs .................... [RUN]
[0m11:54:14.553464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_calcs)
[0m11:54:14.553646 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calcs
[0m11:54:14.557837 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calcs"
[0m11:54:14.558308 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calcs
[0m11:54:14.572305 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calcs"
[0m11:54:14.573443 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calcs"
[0m11:54:14.573675 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calcs"} */
create or replace   view stock_db.analytics_analytics.stock_calcs
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        ABS(SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        )) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m11:54:14.573893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:14.948591 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f4a-0004-2f06-0002-1feb0004937e
[0m11:54:14.948879 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 69 at position 56 unexpected ';'.
[0m11:54:14.949122 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: Close
[0m11:54:15.094985 [debug] [Thread-1 (]: Database Error in model stock_calcs (models/output/stock_calcs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m11:54:15.095992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6ccea2-5a8f-4837-b2f4-dc718d30b530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de9940>]}
[0m11:54:15.096339 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_analytics.stock_calcs ........... [[31mERROR[0m in 0.54s]
[0m11:54:15.096656 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calcs
[0m11:54:15.097629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:15.098007 [debug] [MainThread]: Connection 'model.build_ELT.stock_calcs' was properly closed.
[0m11:54:15.098172 [info ] [MainThread]: 
[0m11:54:15.098331 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m11:54:15.098633 [debug] [MainThread]: Command end result
[0m11:54:15.118945 [info ] [MainThread]: 
[0m11:54:15.119207 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:54:15.119360 [info ] [MainThread]: 
[0m11:54:15.119545 [error] [MainThread]:   Database Error in model stock_calcs (models/output/stock_calcs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m11:54:15.119687 [info ] [MainThread]: 
[0m11:54:15.119835 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:54:15.121917 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.427396, "process_user_time": 2.386262, "process_kernel_time": 1.594561, "process_mem_max_rss": "206766080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:54:15.122237 [debug] [MainThread]: Command `dbt run` failed at 11:54:15.122187 after 3.43 seconds
[0m11:54:15.122440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ecbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092bc0e0>]}
[0m11:54:15.122618 [debug] [MainThread]: Flushing usage events
[0m11:54:40.765446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f8f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133957f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133953d0>]}


============================== 11:54:40.768020 | 66ff5d0b-1653-44f5-b77e-27e99983a91d ==============================
[0m11:54:40.768020 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:54:40.768407 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'fail_fast': 'False', 'debug': 'False', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select stock_calcs', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False'}
[0m11:54:41.502543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66ff5d0b-1653-44f5-b77e-27e99983a91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147dcbfb0>]}
[0m11:54:41.528600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66ff5d0b-1653-44f5-b77e-27e99983a91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d2fce0>]}
[0m11:54:41.529249 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:54:41.600862 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:54:41.691431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:54:41.691871 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/output/stock_calcs.sql
[0m11:54:41.813715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m11:54:41.819877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66ff5d0b-1653-44f5-b77e-27e99983a91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148451160>]}
[0m11:54:41.870532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66ff5d0b-1653-44f5-b77e-27e99983a91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148660440>]}
[0m11:54:41.870844 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m11:54:41.871024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66ff5d0b-1653-44f5-b77e-27e99983a91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1489d3ce0>]}
[0m11:54:41.871754 [info ] [MainThread]: 
[0m11:54:41.872061 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:54:41.872496 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m11:54:41.879186 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m11:54:41.879372 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m11:54:41.879513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:42.775682 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.896 seconds
[0m11:54:42.778800 [debug] [ThreadPool]: On list_stock_db: Close
[0m11:54:43.395595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m11:54:43.400546 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m11:54:43.400742 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:54:43.400886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:43.870653 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.469 seconds
[0m11:54:43.874692 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m11:54:44.004901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66ff5d0b-1653-44f5-b77e-27e99983a91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1484817f0>]}
[0m11:54:44.005974 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:54:44.006513 [info ] [MainThread]: 
[0m11:54:44.009763 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calcs
[0m11:54:44.010199 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_analytics.stock_calcs .................... [RUN]
[0m11:54:44.010475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_calcs)
[0m11:54:44.010652 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calcs
[0m11:54:44.014821 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calcs"
[0m11:54:44.015355 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calcs
[0m11:54:44.029095 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calcs"
[0m11:54:44.030226 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calcs"
[0m11:54:44.030455 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calcs"} */
create or replace   view stock_db.analytics_analytics.stock_calcs
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        ABS(SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        )) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol"
  );
[0m11:54:44.030678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:44.448232 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f4a-0004-2f06-0002-1feb00049386
[0m11:54:44.448568 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002303 (0A000): SQL compilation error: error line 48 at position 12
Sliding window frame unsupported for function ABS
[0m11:54:44.448839 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: Close
[0m11:54:44.573700 [debug] [Thread-1 (]: Database Error in model stock_calcs (models/output/stock_calcs.sql)
  002303 (0A000): SQL compilation error: error line 48 at position 12
  Sliding window frame unsupported for function ABS
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m11:54:44.574620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66ff5d0b-1653-44f5-b77e-27e99983a91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112839970>]}
[0m11:54:44.574995 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_analytics.stock_calcs ........... [[31mERROR[0m in 0.56s]
[0m11:54:44.575310 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calcs
[0m11:54:44.576325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:44.576517 [debug] [MainThread]: Connection 'model.build_ELT.stock_calcs' was properly closed.
[0m11:54:44.576679 [info ] [MainThread]: 
[0m11:54:44.576839 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m11:54:44.577140 [debug] [MainThread]: Command end result
[0m11:54:44.593138 [info ] [MainThread]: 
[0m11:54:44.593398 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:54:44.593557 [info ] [MainThread]: 
[0m11:54:44.593739 [error] [MainThread]:   Database Error in model stock_calcs (models/output/stock_calcs.sql)
  002303 (0A000): SQL compilation error: error line 48 at position 12
  Sliding window frame unsupported for function ABS
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m11:54:44.593883 [info ] [MainThread]: 
[0m11:54:44.594039 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:54:44.595474 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.8656263, "process_user_time": 2.665204, "process_kernel_time": 0.830329, "process_mem_max_rss": "194215936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:54:44.595772 [debug] [MainThread]: Command `dbt run` failed at 11:54:44.595730 after 3.87 seconds
[0m11:54:44.595954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f8f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148660380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d00380>]}
[0m11:54:44.596119 [debug] [MainThread]: Flushing usage events
[0m11:55:09.939725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11006d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11006d370>]}


============================== 11:55:09.942733 | 7aabf9b1-1b68-40be-ad3e-8205326bd877 ==============================
[0m11:55:09.942733 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:55:09.943119 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select stock_calcs', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m11:55:10.877098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7aabf9b1-1b68-40be-ad3e-8205326bd877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106269820>]}
[0m11:55:10.901579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7aabf9b1-1b68-40be-ad3e-8205326bd877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1556cd3d0>]}
[0m11:55:10.902222 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:55:10.967641 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:55:11.057611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:55:11.057975 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/output/stock_calcs.sql
[0m11:55:11.167963 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m11:55:11.173883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aabf9b1-1b68-40be-ad3e-8205326bd877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155dc7800>]}
[0m11:55:11.226751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7aabf9b1-1b68-40be-ad3e-8205326bd877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155b70200>]}
[0m11:55:11.227071 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m11:55:11.227245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aabf9b1-1b68-40be-ad3e-8205326bd877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155d99460>]}
[0m11:55:11.227976 [info ] [MainThread]: 
[0m11:55:11.228315 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:55:11.228795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m11:55:11.235645 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m11:55:11.235871 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m11:55:11.236023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:11.718705 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.482 seconds
[0m11:55:11.722444 [debug] [ThreadPool]: On list_stock_db: Close
[0m11:55:11.840994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m11:55:11.846135 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m11:55:11.846405 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m11:55:11.846557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:12.267324 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.421 seconds
[0m11:55:12.271014 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m11:55:12.386821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aabf9b1-1b68-40be-ad3e-8205326bd877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155b703e0>]}
[0m11:55:12.387775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:55:12.388538 [info ] [MainThread]: 
[0m11:55:12.391238 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calcs
[0m11:55:12.391643 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_analytics.stock_calcs .................... [RUN]
[0m11:55:12.391932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_calcs)
[0m11:55:12.392108 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calcs
[0m11:55:12.396292 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calcs"
[0m11:55:12.396807 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calcs
[0m11:55:12.410648 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calcs"
[0m11:55:12.411813 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calcs"
[0m11:55:12.412052 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calcs"} */
create or replace   view stock_db.analytics_analytics.stock_calcs
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        ABS(SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        )) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m11:55:12.412279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:12.879659 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f4b-0004-2f06-0002-1feb00049392
[0m11:55:12.879962 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 69 at position 56 unexpected ';'.
[0m11:55:12.880213 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: Close
[0m11:55:13.038202 [debug] [Thread-1 (]: Database Error in model stock_calcs (models/output/stock_calcs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m11:55:13.039244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aabf9b1-1b68-40be-ad3e-8205326bd877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156059670>]}
[0m11:55:13.039615 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_analytics.stock_calcs ........... [[31mERROR[0m in 0.65s]
[0m11:55:13.039936 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calcs
[0m11:55:13.041014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:13.041207 [debug] [MainThread]: Connection 'model.build_ELT.stock_calcs' was properly closed.
[0m11:55:13.041375 [info ] [MainThread]: 
[0m11:55:13.041543 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m11:55:13.041852 [debug] [MainThread]: Command end result
[0m11:55:13.057720 [info ] [MainThread]: 
[0m11:55:13.057963 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:55:13.058120 [info ] [MainThread]: 
[0m11:55:13.058302 [error] [MainThread]:   Database Error in model stock_calcs (models/output/stock_calcs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m11:55:13.058448 [info ] [MainThread]: 
[0m11:55:13.058595 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:55:13.060050 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1588652, "process_user_time": 2.69932, "process_kernel_time": 0.791404, "process_mem_max_rss": "197853184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:55:13.060336 [debug] [MainThread]: Command `dbt run` failed at 11:55:13.060292 after 3.16 seconds
[0m11:55:13.060522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155d99100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11006d550>]}
[0m11:55:13.060685 [debug] [MainThread]: Flushing usage events
[0m12:04:45.774240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f46840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119859910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198594f0>]}


============================== 12:04:45.777740 | 662acd1c-a2d0-4b1e-ac6d-3cfc85519219 ==============================
[0m12:04:45.777740 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:04:45.778083 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select stock_calcs', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'target_path': 'None', 'debug': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT'}
[0m12:04:47.004122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '662acd1c-a2d0-4b1e-ac6d-3cfc85519219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145993470>]}
[0m12:04:47.029072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '662acd1c-a2d0-4b1e-ac6d-3cfc85519219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11890ea20>]}
[0m12:04:47.029768 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:04:47.097321 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:04:47.192110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:04:47.192538 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/output/stock_calcs.sql
[0m12:04:47.303533 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m12:04:47.309356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '662acd1c-a2d0-4b1e-ac6d-3cfc85519219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1587c7890>]}
[0m12:04:47.364560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '662acd1c-a2d0-4b1e-ac6d-3cfc85519219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158560950>]}
[0m12:04:47.364952 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m12:04:47.365137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '662acd1c-a2d0-4b1e-ac6d-3cfc85519219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15877dac0>]}
[0m12:04:47.365994 [info ] [MainThread]: 
[0m12:04:47.366342 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:04:47.366889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m12:04:47.374206 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m12:04:47.374448 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m12:04:47.374604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:47.922683 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.548 seconds
[0m12:04:47.925171 [debug] [ThreadPool]: On list_stock_db: Close
[0m12:04:48.046125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m12:04:48.051313 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m12:04:48.051533 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m12:04:48.051680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:48.607382 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.555 seconds
[0m12:04:48.611218 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m12:04:48.737166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '662acd1c-a2d0-4b1e-ac6d-3cfc85519219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158120d10>]}
[0m12:04:48.738388 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:04:48.739504 [info ] [MainThread]: 
[0m12:04:48.742805 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calcs
[0m12:04:48.743238 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_analytics.stock_calcs .................... [RUN]
[0m12:04:48.743515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_calcs)
[0m12:04:48.743696 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calcs
[0m12:04:48.747758 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calcs"
[0m12:04:48.748278 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calcs
[0m12:04:48.762488 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calcs"
[0m12:04:48.763793 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calcs"
[0m12:04:48.764038 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calcs"} */
create or replace   view stock_db.analytics_analytics.stock_calcs
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                THEN ABS("close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date"))
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m12:04:48.764249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:49.209752 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f54-0004-2f4f-0002-1feb0004a3ee
[0m12:04:49.210075 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 69 at position 56 unexpected ';'.
[0m12:04:49.210322 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: Close
[0m12:04:49.362623 [debug] [Thread-1 (]: Database Error in model stock_calcs (models/output/stock_calcs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m12:04:49.363522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '662acd1c-a2d0-4b1e-ac6d-3cfc85519219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b39a90>]}
[0m12:04:49.363861 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics_analytics.stock_calcs ........... [[31mERROR[0m in 0.62s]
[0m12:04:49.364165 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calcs
[0m12:04:49.365115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:49.365291 [debug] [MainThread]: Connection 'model.build_ELT.stock_calcs' was properly closed.
[0m12:04:49.365443 [info ] [MainThread]: 
[0m12:04:49.365597 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m12:04:49.365895 [debug] [MainThread]: Command end result
[0m12:04:49.381720 [info ] [MainThread]: 
[0m12:04:49.381963 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:04:49.382122 [info ] [MainThread]: 
[0m12:04:49.382305 [error] [MainThread]:   Database Error in model stock_calcs (models/output/stock_calcs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m12:04:49.382450 [info ] [MainThread]: 
[0m12:04:49.382597 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:04:49.384741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6536255, "process_user_time": 2.344569, "process_kernel_time": 1.707344, "process_mem_max_rss": "195657728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:04:49.385041 [debug] [MainThread]: Command `dbt run` failed at 12:04:49.384998 after 3.65 seconds
[0m12:04:49.385232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119724770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198594f0>]}
[0m12:04:49.385396 [debug] [MainThread]: Flushing usage events
[0m12:42:37.035844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b97140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095f16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095f1280>]}


============================== 12:42:37.041279 | fba9d32a-fa2f-4c99-a599-f4d09fb3ba2f ==============================
[0m12:42:37.041279 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:42:37.041694 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'debug': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'version_check': 'True'}
[0m12:42:38.444263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fba9d32a-fa2f-4c99-a599-f4d09fb3ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13641a9f0>]}
[0m12:42:38.469192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fba9d32a-fa2f-4c99-a599-f4d09fb3ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1366270b0>]}
[0m12:42:38.469951 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:42:38.545861 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:42:38.862932 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 1 files changed.
[0m12:42:38.863388 [debug] [MainThread]: Partial parsing: added file: build_ELT://models/output/schema.yml
[0m12:42:38.863602 [debug] [MainThread]: Partial parsing: added file: build_ELT://models/input/schema.yml
[0m12:42:38.863781 [debug] [MainThread]: Partial parsing: added file: build_ELT://models/input/sources.yml
[0m12:42:38.864063 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/output/stock_calcs.sql
[0m12:42:38.982131 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:42:38.982514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fba9d32a-fa2f-4c99-a599-f4d09fb3ba2f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a272300>]}
[0m12:42:39.050602 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stock_metrics' in the 'models' section of file 'models/input/schema.yml'
[0m12:42:39.104002 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.not_null_stock_metrics_date.c2fdbd617e' (models/input/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m12:42:39.104763 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.unique_stock_metrics_date.a7f1c68ed1' (models/input/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m12:42:39.105106 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7' (models/input/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m12:42:39.105699 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336' (models/input/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m12:42:39.105947 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171' (models/input/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m12:42:39.150135 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m12:42:39.155973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fba9d32a-fa2f-4c99-a599-f4d09fb3ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136e99df0>]}
[0m12:42:39.238569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fba9d32a-fa2f-4c99-a599-f4d09fb3ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136aa8530>]}
[0m12:42:39.238925 [info ] [MainThread]: Found 2 models, 5 data tests, 1 source, 459 macros
[0m12:42:39.239135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba9d32a-fa2f-4c99-a599-f4d09fb3ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136626d20>]}
[0m12:42:39.240198 [info ] [MainThread]: 
[0m12:42:39.240557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:39.243009 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m12:42:39.249827 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m12:42:39.250059 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m12:42:39.250222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:39.888279 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.638 seconds
[0m12:42:39.890983 [debug] [ThreadPool]: On list_stock_db: Close
[0m12:42:40.043533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m12:42:40.051532 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m12:42:40.051824 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m12:42:40.052003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:40.572684 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.520 seconds
[0m12:42:40.576766 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m12:42:40.701222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba9d32a-fa2f-4c99-a599-f4d09fb3ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136e68530>]}
[0m12:42:40.702225 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:40.702783 [info ] [MainThread]: 
[0m12:42:40.705737 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m12:42:40.706127 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_analytics.stock_prices ................... [RUN]
[0m12:42:40.706409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m12:42:40.706580 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m12:42:40.710643 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m12:42:40.711332 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m12:42:40.725558 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m12:42:40.726160 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m12:42:40.726354 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics_analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m12:42:40.726521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:41.405869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.679 seconds
[0m12:42:41.423630 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m12:42:41.557403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fba9d32a-fa2f-4c99-a599-f4d09fb3ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1366245f0>]}
[0m12:42:41.558543 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_analytics.stock_prices .............. [[32mSUCCESS 1[0m in 0.85s]
[0m12:42:41.559463 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m12:42:41.560544 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calcs
[0m12:42:41.561078 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics_analytics.stock_calcs .................... [RUN]
[0m12:42:41.561400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_calcs)
[0m12:42:41.561607 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calcs
[0m12:42:41.563245 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calcs"
[0m12:42:41.563681 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calcs
[0m12:42:41.565151 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calcs"
[0m12:42:41.566233 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calcs"
[0m12:42:41.566452 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calcs"} */
create or replace   view stock_db.analytics_analytics.stock_calcs
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        ABS(SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        )) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol"
  );
[0m12:42:41.566650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:42.037090 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f7a-0004-2f06-0002-1feb000493ce
[0m12:42:42.037543 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002303 (0A000): SQL compilation error: error line 48 at position 12
Sliding window frame unsupported for function ABS
[0m12:42:42.037833 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: Close
[0m12:42:42.175652 [debug] [Thread-1 (]: Database Error in model stock_calcs (models/output/stock_calcs.sql)
  002303 (0A000): SQL compilation error: error line 48 at position 12
  Sliding window frame unsupported for function ABS
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m12:42:42.176082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fba9d32a-fa2f-4c99-a599-f4d09fb3ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137176690>]}
[0m12:42:42.176515 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics_analytics.stock_calcs ........... [[31mERROR[0m in 0.61s]
[0m12:42:42.176821 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calcs
[0m12:42:42.177963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:42.178211 [debug] [MainThread]: Connection 'model.build_ELT.stock_calcs' was properly closed.
[0m12:42:42.178480 [info ] [MainThread]: 
[0m12:42:42.178665 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m12:42:42.179143 [debug] [MainThread]: Command end result
[0m12:42:42.255132 [info ] [MainThread]: 
[0m12:42:42.255458 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:42:42.255662 [info ] [MainThread]: 
[0m12:42:42.255868 [error] [MainThread]:   Database Error in model stock_calcs (models/output/stock_calcs.sql)
  002303 (0A000): SQL compilation error: error line 48 at position 12
  Sliding window frame unsupported for function ABS
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m12:42:42.256072 [info ] [MainThread]: 
[0m12:42:42.256288 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:42:42.258681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.2785416, "process_user_time": 3.013849, "process_kernel_time": 1.281379, "process_mem_max_rss": "190464000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:42:42.259011 [debug] [MainThread]: Command `dbt run` failed at 12:42:42.258964 after 5.28 seconds
[0m12:42:42.259230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108687b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10558b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f84e00>]}
[0m12:42:42.259420 [debug] [MainThread]: Flushing usage events
[0m12:44:05.298518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b1f2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dad640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dad250>]}


============================== 12:44:05.302938 | b6289cfe-f001-4d27-9159-b2c215bd9b47 ==============================
[0m12:44:05.302938 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:44:05.303467 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'printer_width': '80', 'static_parser': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'empty': 'False', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'target_path': 'None', 'partial_parse': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'warn_error': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:44:06.558106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6289cfe-f001-4d27-9159-b2c215bd9b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a121dc0>]}
[0m12:44:06.582894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6289cfe-f001-4d27-9159-b2c215bd9b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cd51e20>]}
[0m12:44:06.583582 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:44:06.658769 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:44:06.757880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:44:06.758315 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/output/stock_calcs.sql
[0m12:44:06.858024 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:44:06.858357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b6289cfe-f001-4d27-9159-b2c215bd9b47', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb88d10>]}
[0m12:44:06.944601 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m12:44:06.950629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6289cfe-f001-4d27-9159-b2c215bd9b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fcd5760>]}
[0m12:44:07.017141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6289cfe-f001-4d27-9159-b2c215bd9b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fdbc770>]}
[0m12:44:07.017476 [info ] [MainThread]: Found 2 models, 5 data tests, 1 source, 459 macros
[0m12:44:07.017678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6289cfe-f001-4d27-9159-b2c215bd9b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbac830>]}
[0m12:44:07.018608 [info ] [MainThread]: 
[0m12:44:07.018933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:44:07.021130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m12:44:07.028199 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m12:44:07.028492 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m12:44:07.028656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:07.634559 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.606 seconds
[0m12:44:07.637913 [debug] [ThreadPool]: On list_stock_db: Close
[0m12:44:07.786770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m12:44:07.794232 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m12:44:07.794497 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m12:44:07.794653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:08.286972 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.492 seconds
[0m12:44:08.292845 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m12:44:08.459985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6289cfe-f001-4d27-9159-b2c215bd9b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecd430>]}
[0m12:44:08.461405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:08.462373 [info ] [MainThread]: 
[0m12:44:08.467089 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m12:44:08.467660 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_analytics.stock_prices ................... [RUN]
[0m12:44:08.468255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m12:44:08.468710 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m12:44:08.473873 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m12:44:08.474905 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m12:44:08.489962 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m12:44:08.490630 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m12:44:08.490836 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics_analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m12:44:08.491010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:09.066262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m12:44:09.084467 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m12:44:09.209699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6289cfe-f001-4d27-9159-b2c215bd9b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109239ac0>]}
[0m12:44:09.211014 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_analytics.stock_prices .............. [[32mSUCCESS 1[0m in 0.74s]
[0m12:44:09.211905 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m12:44:09.212952 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calcs
[0m12:44:09.213322 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics_analytics.stock_calcs .................... [RUN]
[0m12:44:09.213623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_calcs)
[0m12:44:09.213817 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calcs
[0m12:44:09.215525 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calcs"
[0m12:44:09.216226 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calcs
[0m12:44:09.217716 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calcs"
[0m12:44:09.218853 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calcs"
[0m12:44:09.219083 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calcs"} */
create or replace   view stock_db.analytics_analytics.stock_calcs
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                THEN ABS("close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date"))
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol";
[0m12:44:09.219304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:09.668129 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f7c-0004-2f06-0002-1feb000493de
[0m12:44:09.668547 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 69 at position 56 unexpected ';'.
[0m12:44:09.668892 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: Close
[0m12:44:09.845973 [debug] [Thread-1 (]: Database Error in model stock_calcs (models/output/stock_calcs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m12:44:09.846499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6289cfe-f001-4d27-9159-b2c215bd9b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d7eb8c0>]}
[0m12:44:09.846945 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics_analytics.stock_calcs ........... [[31mERROR[0m in 0.63s]
[0m12:44:09.847278 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calcs
[0m12:44:09.849250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:09.849698 [debug] [MainThread]: Connection 'model.build_ELT.stock_calcs' was properly closed.
[0m12:44:09.849977 [info ] [MainThread]: 
[0m12:44:09.850254 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m12:44:09.850756 [debug] [MainThread]: Command end result
[0m12:44:09.870566 [info ] [MainThread]: 
[0m12:44:09.871032 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:44:09.871831 [info ] [MainThread]: 
[0m12:44:09.872767 [error] [MainThread]:   Database Error in model stock_calcs (models/output/stock_calcs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 56 unexpected ';'.
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m12:44:09.873730 [info ] [MainThread]: 
[0m12:44:09.874456 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:44:09.877438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6403513, "process_user_time": 2.694215, "process_kernel_time": 1.594412, "process_mem_max_rss": "189579264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:44:09.877904 [debug] [MainThread]: Command `dbt run` failed at 12:44:09.877841 after 4.64 seconds
[0m12:44:09.878179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dad3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dad550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109239430>]}
[0m12:44:09.878371 [debug] [MainThread]: Flushing usage events
[0m12:44:23.128449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f65a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f95940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f95520>]}


============================== 12:44:23.131487 | ee3303c7-ad15-4e8d-a913-ec1c3ab25129 ==============================
[0m12:44:23.131487 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:44:23.131866 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'target_path': 'None', 'introspect': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'version_check': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'False', 'quiet': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_format': 'default'}
[0m12:44:24.040973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee3303c7-ad15-4e8d-a913-ec1c3ab25129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f24500>]}
[0m12:44:24.065599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee3303c7-ad15-4e8d-a913-ec1c3ab25129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a9a780>]}
[0m12:44:24.066309 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:44:24.139820 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:44:24.240699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:44:24.241172 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/output/stock_calcs.sql
[0m12:44:24.362826 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:44:24.363196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee3303c7-ad15-4e8d-a913-ec1c3ab25129', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f5a3c0>]}
[0m12:44:24.457668 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m12:44:24.464377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee3303c7-ad15-4e8d-a913-ec1c3ab25129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12158ce90>]}
[0m12:44:24.527531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee3303c7-ad15-4e8d-a913-ec1c3ab25129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217b87d0>]}
[0m12:44:24.528223 [info ] [MainThread]: Found 2 models, 5 data tests, 1 source, 459 macros
[0m12:44:24.528478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee3303c7-ad15-4e8d-a913-ec1c3ab25129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217ef140>]}
[0m12:44:24.529618 [info ] [MainThread]: 
[0m12:44:24.530086 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:44:24.532637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m12:44:24.540717 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m12:44:24.541004 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m12:44:24.541202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:25.022857 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.481 seconds
[0m12:44:25.026301 [debug] [ThreadPool]: On list_stock_db: Close
[0m12:44:25.162692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m12:44:25.171137 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m12:44:25.171450 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m12:44:25.171608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:25.614585 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.443 seconds
[0m12:44:25.618561 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m12:44:25.787239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee3303c7-ad15-4e8d-a913-ec1c3ab25129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121179c40>]}
[0m12:44:25.788216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:25.788709 [info ] [MainThread]: 
[0m12:44:25.791616 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m12:44:25.792045 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_analytics.stock_prices ................... [RUN]
[0m12:44:25.792351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m12:44:25.792570 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m12:44:25.797214 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m12:44:25.797843 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m12:44:25.814854 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m12:44:25.815636 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m12:44:25.815885 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics_analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m12:44:25.816080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:26.393452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m12:44:26.411072 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m12:44:26.540915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3303c7-ad15-4e8d-a913-ec1c3ab25129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653d790>]}
[0m12:44:26.542213 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_analytics.stock_prices .............. [[32mSUCCESS 1[0m in 0.75s]
[0m12:44:26.543201 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m12:44:26.544523 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calcs
[0m12:44:26.544884 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics_analytics.stock_calcs .................... [RUN]
[0m12:44:26.545177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_calcs)
[0m12:44:26.545379 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calcs
[0m12:44:26.547298 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calcs"
[0m12:44:26.547838 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calcs
[0m12:44:26.549521 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calcs"
[0m12:44:26.550734 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calcs"
[0m12:44:26.550984 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calcs"} */
create or replace   view stock_db.analytics_analytics.stock_calcs
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM stock_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") > 0
                THEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date")
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        SUM(
            CASE 
                WHEN "close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") < 0
                THEN ABS("close" - LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date"))
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM stock_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol"
  );
[0m12:44:26.551202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:27.025299 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f7c-0004-2f06-0002-1feb000493ea
[0m12:44:27.025618 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002062 (42601): SQL compilation error:
Window function [LAG(STOCK_DATA."close") OVER (PARTITION BY STOCK_DATA."symbol" ORDER BY STOCK_DATA."date" ASC NULLS LAST)] may not be nested inside another window function.
[0m12:44:27.025864 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: Close
[0m12:44:27.157681 [debug] [Thread-1 (]: Database Error in model stock_calcs (models/output/stock_calcs.sql)
  002062 (42601): SQL compilation error:
  Window function [LAG(STOCK_DATA."close") OVER (PARTITION BY STOCK_DATA."symbol" ORDER BY STOCK_DATA."date" ASC NULLS LAST)] may not be nested inside another window function.
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m12:44:27.158043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3303c7-ad15-4e8d-a913-ec1c3ab25129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13019b380>]}
[0m12:44:27.158378 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model analytics_analytics.stock_calcs ........... [[31mERROR[0m in 0.61s]
[0m12:44:27.158678 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calcs
[0m12:44:27.159858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:27.160051 [debug] [MainThread]: Connection 'model.build_ELT.stock_calcs' was properly closed.
[0m12:44:27.160296 [info ] [MainThread]: 
[0m12:44:27.160468 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m12:44:27.160863 [debug] [MainThread]: Command end result
[0m12:44:27.256887 [info ] [MainThread]: 
[0m12:44:27.257177 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:44:27.257345 [info ] [MainThread]: 
[0m12:44:27.257548 [error] [MainThread]:   Database Error in model stock_calcs (models/output/stock_calcs.sql)
  002062 (42601): SQL compilation error:
  Window function [LAG(STOCK_DATA."close") OVER (PARTITION BY STOCK_DATA."symbol" ORDER BY STOCK_DATA."date" ASC NULLS LAST)] may not be nested inside another window function.
  compiled code at target/run/build_ELT/models/output/stock_calcs.sql
[0m12:44:27.257766 [info ] [MainThread]: 
[0m12:44:27.257977 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:44:27.259588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.1846533, "process_user_time": 2.919682, "process_kernel_time": 0.659884, "process_mem_max_rss": "188547072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:44:27.259922 [debug] [MainThread]: Command `dbt run` failed at 12:44:27.259868 after 4.19 seconds
[0m12:44:27.260149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069db6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1301c9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1301ca720>]}
[0m12:44:27.260340 [debug] [MainThread]: Flushing usage events
[0m12:54:57.579073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e437d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106905970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106905550>]}


============================== 12:54:57.582355 | b67ec81e-500e-4ed1-b9f6-14fd23e9ddcf ==============================
[0m12:54:57.582355 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:54:57.582707 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'log_format': 'default', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'warn_error': 'None', 'printer_width': '80', 'empty': 'False', 'no_print': 'None', 'version_check': 'True', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT'}
[0m12:54:58.822376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b67ec81e-500e-4ed1-b9f6-14fd23e9ddcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe972c0>]}
[0m12:54:58.847519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b67ec81e-500e-4ed1-b9f6-14fd23e9ddcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1301cd460>]}
[0m12:54:58.848184 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:54:58.925454 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:54:59.021981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:54:59.022407 [debug] [MainThread]: Partial parsing: updated file: build_ELT://models/output/stock_calcs.sql
[0m12:54:59.130595 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:54:59.130959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b67ec81e-500e-4ed1-b9f6-14fd23e9ddcf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e43fb0>]}
[0m12:54:59.216830 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m12:54:59.222922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b67ec81e-500e-4ed1-b9f6-14fd23e9ddcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306243e0>]}
[0m12:54:59.277728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b67ec81e-500e-4ed1-b9f6-14fd23e9ddcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13089dcd0>]}
[0m12:54:59.278063 [info ] [MainThread]: Found 2 models, 5 data tests, 1 source, 459 macros
[0m12:54:59.278246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b67ec81e-500e-4ed1-b9f6-14fd23e9ddcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130257800>]}
[0m12:54:59.279152 [info ] [MainThread]: 
[0m12:54:59.279491 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:54:59.281646 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m12:54:59.288561 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m12:54:59.288963 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m12:54:59.289140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:59.843319 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.554 seconds
[0m12:54:59.847455 [debug] [ThreadPool]: On list_stock_db: Close
[0m12:54:59.975035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics_analytics)
[0m12:54:59.982455 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics_analytics"
[0m12:54:59.982726 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics_analytics"} */
show objects in stock_db.analytics_analytics limit 10000
[0m12:54:59.982873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:00.424191 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.441 seconds
[0m12:55:00.427809 [debug] [ThreadPool]: On list_stock_db_analytics_analytics: Close
[0m12:55:00.557630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b67ec81e-500e-4ed1-b9f6-14fd23e9ddcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130515a00>]}
[0m12:55:00.558831 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:55:00.559548 [info ] [MainThread]: 
[0m12:55:00.562358 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m12:55:00.562804 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_analytics.stock_prices ................... [RUN]
[0m12:55:00.563117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics_analytics, now model.build_ELT.stock_prices)
[0m12:55:00.563298 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m12:55:00.567595 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m12:55:00.568337 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m12:55:00.583092 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m12:55:00.583667 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m12:55:00.583844 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics_analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m12:55:00.584002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:01.238966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.655 seconds
[0m12:55:01.256460 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m12:55:01.427629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67ec81e-500e-4ed1-b9f6-14fd23e9ddcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ead7f0>]}
[0m12:55:01.428815 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_analytics.stock_prices .............. [[32mSUCCESS 1[0m in 0.86s]
[0m12:55:01.429868 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m12:55:01.431049 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calcs
[0m12:55:01.431685 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics_analytics.stock_calcs .................... [RUN]
[0m12:55:01.432286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_calcs)
[0m12:55:01.432763 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calcs
[0m12:55:01.434549 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calcs"
[0m12:55:01.435271 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calcs
[0m12:55:01.436799 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calcs"
[0m12:55:01.437868 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calcs"
[0m12:55:01.438091 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calcs"} */
create or replace   view stock_db.analytics_analytics.stock_calcs
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics_analytics.stock_prices
),
lagged_data AS (
    SELECT
        "date",
        "symbol",
        "close",
        LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") AS lag_close
    FROM stock_data
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM lagged_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - lag_close > 0 THEN "close" - lag_close
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        SUM(
            CASE 
                WHEN "close" - lag_close < 0 THEN ABS("close" - lag_close)
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM lagged_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol"
  );
[0m12:55:01.438318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:02.140959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m12:55:02.145757 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: Close
[0m12:55:02.270962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67ec81e-500e-4ed1-b9f6-14fd23e9ddcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130cc7500>]}
[0m12:55:02.272209 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics_analytics.stock_calcs ............... [[32mSUCCESS 1[0m in 0.84s]
[0m12:55:02.273179 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calcs
[0m12:55:02.274625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:02.275054 [debug] [MainThread]: Connection 'model.build_ELT.stock_calcs' was properly closed.
[0m12:55:02.275572 [info ] [MainThread]: 
[0m12:55:02.275815 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m12:55:02.276312 [debug] [MainThread]: Command end result
[0m12:55:02.348364 [info ] [MainThread]: 
[0m12:55:02.348654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:55:02.348814 [info ] [MainThread]: 
[0m12:55:02.348977 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:55:02.351293 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8161592, "process_user_time": 2.718018, "process_kernel_time": 1.633568, "process_mem_max_rss": "190119936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:55:02.351632 [debug] [MainThread]: Command `dbt run` succeeded at 12:55:02.351577 after 4.82 seconds
[0m12:55:02.351835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063801a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130d9eb40>]}
[0m12:55:02.352017 [debug] [MainThread]: Flushing usage events
[0m13:08:12.901163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e799d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e795e0>]}


============================== 13:08:12.914303 | 3fdde8ce-8283-44d5-bb4b-5d8ced25b329 ==============================
[0m13:08:12.914303 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:08:12.914857 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'log_format': 'default', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'invocation_command': 'dbt run', 'version_check': 'True', 'target_path': 'None', 'empty': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'introspect': 'True'}
[0m13:08:14.649075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fdde8ce-8283-44d5-bb4b-5d8ced25b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104913c80>]}
[0m13:08:14.675793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fdde8ce-8283-44d5-bb4b-5d8ced25b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118229310>]}
[0m13:08:14.676490 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:08:14.752571 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:08:14.827808 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:08:14.828160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3fdde8ce-8283-44d5-bb4b-5d8ced25b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e24e00>]}
[0m13:08:15.702833 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:08:15.735123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3fdde8ce-8283-44d5-bb4b-5d8ced25b329', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f77bbc0>]}
[0m13:08:15.741777 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stock_metrics' in the 'models' section of file 'models/input/schema.yml'
[0m13:08:15.825701 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.not_null_stock_metrics_date.c2fdbd617e' (models/input/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m13:08:15.826019 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.unique_stock_metrics_date.a7f1c68ed1' (models/input/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m13:08:15.826202 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.not_null_stock_metrics_symbol.991b6d7cf7' (models/input/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m13:08:15.826362 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.not_null_stock_metrics_moving_avg_7d.7063b6f336' (models/input/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m13:08:15.826508 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.build_ELT.not_null_stock_metrics_rsi_14d.435e534171' (models/input/schema.yml) depends on a node named 'stock_metrics' in package '' which was not found
[0m13:08:15.877955 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m13:08:15.883361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fdde8ce-8283-44d5-bb4b-5d8ced25b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1292d06b0>]}
[0m13:08:15.974580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fdde8ce-8283-44d5-bb4b-5d8ced25b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128e810a0>]}
[0m13:08:15.974937 [info ] [MainThread]: Found 2 models, 1 snapshot, 5 data tests, 1 source, 459 macros
[0m13:08:15.975225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fdde8ce-8283-44d5-bb4b-5d8ced25b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128bed670>]}
[0m13:08:15.976179 [info ] [MainThread]: 
[0m13:08:15.976505 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:08:15.978703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m13:08:15.986359 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m13:08:15.986655 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m13:08:15.986814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:17.296022 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.307 seconds
[0m13:08:17.299522 [debug] [ThreadPool]: On list_stock_db: Close
[0m13:08:17.437466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_snapshot)
[0m13:08:17.445535 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_snapshot"
[0m13:08:17.445809 [debug] [ThreadPool]: On list_stock_db_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_snapshot"} */
show objects in stock_db.snapshot limit 10000
[0m13:08:17.445973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:18.335836 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b85f94-0004-2f06-0002-1feb000495b6
[0m13:08:18.336540 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m13:08:18.336854 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m13:08:18.337016 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:08:18.337254 [debug] [ThreadPool]: On list_stock_db_snapshot: Close
[0m13:08:18.479059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db_snapshot, now list_stock_db_analytics)
[0m13:08:18.484401 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m13:08:18.484746 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m13:08:18.484912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:19.450779 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.965 seconds
[0m13:08:19.458036 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m13:08:19.784976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fdde8ce-8283-44d5-bb4b-5d8ced25b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e251c0>]}
[0m13:08:19.786699 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:08:19.787438 [info ] [MainThread]: 
[0m13:08:19.790097 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m13:08:19.790490 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stock_prices ............................. [RUN]
[0m13:08:19.790784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now model.build_ELT.stock_prices)
[0m13:08:19.790968 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m13:08:19.795946 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m13:08:19.796595 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m13:08:19.811762 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m13:08:19.812327 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m13:08:19.812515 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m13:08:19.812714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:20.594392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m13:08:20.611309 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m13:08:20.893741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdde8ce-8283-44d5-bb4b-5d8ced25b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a985c0>]}
[0m13:08:20.895660 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 1.10s]
[0m13:08:20.897039 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m13:08:20.898196 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calcs
[0m13:08:20.899234 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.stock_calcs .............................. [RUN]
[0m13:08:20.900526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_calcs)
[0m13:08:20.900932 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calcs
[0m13:08:20.904958 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calcs"
[0m13:08:20.907053 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calcs
[0m13:08:20.910159 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calcs"
[0m13:08:20.911742 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calcs"
[0m13:08:20.912043 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calcs"} */
create or replace   view stock_db.analytics.stock_calcs
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics.stock_prices
),
lagged_data AS (
    SELECT
        "date",
        "symbol",
        "close",
        LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") AS lag_close
    FROM stock_data
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM lagged_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - lag_close > 0 THEN "close" - lag_close
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        SUM(
            CASE 
                WHEN "close" - lag_close < 0 THEN ABS("close" - lag_close)
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM lagged_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol"
  );
[0m13:08:20.912462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:21.862212 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.949 seconds
[0m13:08:21.872085 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: Close
[0m13:08:22.030698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdde8ce-8283-44d5-bb4b-5d8ced25b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580b140>]}
[0m13:08:22.032452 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.stock_calcs ......................... [[32mSUCCESS 1[0m in 1.13s]
[0m13:08:22.033913 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calcs
[0m13:08:22.036076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:22.037924 [debug] [MainThread]: Connection 'model.build_ELT.stock_calcs' was properly closed.
[0m13:08:22.038334 [info ] [MainThread]: 
[0m13:08:22.038576 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 6.06 seconds (6.06s).
[0m13:08:22.039276 [debug] [MainThread]: Command end result
[0m13:08:22.061311 [info ] [MainThread]: 
[0m13:08:22.061623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:08:22.061798 [info ] [MainThread]: 
[0m13:08:22.062029 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:08:22.066357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.255378, "process_user_time": 4.136563, "process_kernel_time": 0.76121, "process_mem_max_rss": "190218240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:08:22.067442 [debug] [MainThread]: Command `dbt run` succeeded at 13:08:22.067285 after 9.26 seconds
[0m13:08:22.068570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129773f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e79640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1297ff980>]}
[0m13:08:22.069481 [debug] [MainThread]: Flushing usage events
[0m13:16:35.836968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106630e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093657f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109365400>]}


============================== 13:16:35.840814 | e55c299d-e455-403a-9798-d763b03b583a ==============================
[0m13:16:35.840814 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:16:35.841174 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'empty': 'False', 'target_path': 'None', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'use_colors': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'write_json': 'True', 'debug': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m13:16:37.030614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e55c299d-e455-403a-9798-d763b03b583a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a859100>]}
[0m13:16:37.057563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e55c299d-e455-403a-9798-d763b03b583a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a82b0b0>]}
[0m13:16:37.058615 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:16:37.129902 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:16:37.411052 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m13:16:37.457946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m13:16:37.464408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e55c299d-e455-403a-9798-d763b03b583a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a858da0>]}
[0m13:16:37.530056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e55c299d-e455-403a-9798-d763b03b583a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aca20c0>]}
[0m13:16:37.530381 [info ] [MainThread]: Found 2 models, 1 snapshot, 5 data tests, 1 source, 459 macros
[0m13:16:37.530573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e55c299d-e455-403a-9798-d763b03b583a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12add33e0>]}
[0m13:16:37.531578 [info ] [MainThread]: 
[0m13:16:37.531905 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:16:37.534073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m13:16:37.541352 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m13:16:37.541547 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m13:16:37.541695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:38.089677 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.548 seconds
[0m13:16:38.092746 [debug] [ThreadPool]: On list_stock_db: Close
[0m13:16:38.287557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics)
[0m13:16:38.294877 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m13:16:38.295148 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m13:16:38.295299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:38.775962 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.480 seconds
[0m13:16:38.778852 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m13:16:38.919418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now list_stock_db_snapshot)
[0m13:16:38.924337 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_snapshot"
[0m13:16:38.924800 [debug] [ThreadPool]: On list_stock_db_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_snapshot"} */
show objects in stock_db.snapshot limit 10000
[0m13:16:38.925287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:39.427487 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b85f9c-0004-2f06-0002-1feb0004968e
[0m13:16:39.427801 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m13:16:39.428040 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m13:16:39.428187 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:16:39.428360 [debug] [ThreadPool]: On list_stock_db_snapshot: Close
[0m13:16:39.552923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e55c299d-e455-403a-9798-d763b03b583a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a8588f0>]}
[0m13:16:39.554088 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:39.554717 [info ] [MainThread]: 
[0m13:16:39.557653 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_prices
[0m13:16:39.558453 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stock_prices ............................. [RUN]
[0m13:16:39.558849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_snapshot, now model.build_ELT.stock_prices)
[0m13:16:39.559030 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_prices
[0m13:16:39.563218 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_prices"
[0m13:16:39.563937 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_prices
[0m13:16:39.578154 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_prices"
[0m13:16:39.578683 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_prices"
[0m13:16:39.578879 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_prices"} */
create or replace   view stock_db.analytics.stock_prices
  
   as (
    SELECT
    "open",
    "high",
    "low",
    "close",
    "volume",
    "date",
    "symbol"
FROM stock_db.raw_data.stock_prices
  );
[0m13:16:39.579041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:40.311867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m13:16:40.328588 [debug] [Thread-1 (]: On model.build_ELT.stock_prices: Close
[0m13:16:40.456509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e55c299d-e455-403a-9798-d763b03b583a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a8284a0>]}
[0m13:16:40.457681 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.90s]
[0m13:16:40.458546 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_prices
[0m13:16:40.459700 [debug] [Thread-1 (]: Began running node model.build_ELT.stock_calcs
[0m13:16:40.460398 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.stock_calcs .............................. [RUN]
[0m13:16:40.460873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_ELT.stock_prices, now model.build_ELT.stock_calcs)
[0m13:16:40.461075 [debug] [Thread-1 (]: Began compiling node model.build_ELT.stock_calcs
[0m13:16:40.462914 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_ELT.stock_calcs"
[0m13:16:40.464410 [debug] [Thread-1 (]: Began executing node model.build_ELT.stock_calcs
[0m13:16:40.466755 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_ELT.stock_calcs"
[0m13:16:40.467848 [debug] [Thread-1 (]: Using snowflake connection "model.build_ELT.stock_calcs"
[0m13:16:40.468069 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "model.build_ELT.stock_calcs"} */
create or replace   view stock_db.analytics.stock_calcs
  
   as (
    WITH stock_data AS (
    SELECT 
        "date",
        "symbol",
        "close"
    FROM stock_db.analytics.stock_prices
),
lagged_data AS (
    SELECT
        "date",
        "symbol",
        "close",
        LAG("close") OVER (PARTITION BY "symbol" ORDER BY "date") AS lag_close
    FROM stock_data
),
moving_averages AS (
    SELECT
        "date",
        "symbol",
        "close",
        AVG("close") OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS moving_avg_7d
    FROM lagged_data
),
rsi_calculation AS (
    SELECT
        "date",
        "symbol",
        "close",
        SUM(
            CASE 
                WHEN "close" - lag_close > 0 THEN "close" - lag_close
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS gain,
        SUM(
            CASE 
                WHEN "close" - lag_close < 0 THEN ABS("close" - lag_close)
                ELSE 0 
            END
        ) OVER (
            PARTITION BY "symbol"
            ORDER BY "date"
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS loss
    FROM lagged_data
),
rsi_final AS (
    SELECT
        "date",
        "symbol",
        CASE
            WHEN loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (gain / NULLIF(loss, 0))))
        END AS rsi_14d
    FROM rsi_calculation
)
SELECT 
    ma."date" AS date,
    ma."symbol" AS symbol,
    ma.moving_avg_7d AS moving_avg_7d,
    rsi.rsi_14d AS rsi_14d
FROM moving_averages ma
LEFT JOIN rsi_final rsi
ON ma."date" = rsi."date" AND ma."symbol" = rsi."symbol"
  );
[0m13:16:40.468297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:41.156682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m13:16:41.161272 [debug] [Thread-1 (]: On model.build_ELT.stock_calcs: Close
[0m13:16:41.303575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e55c299d-e455-403a-9798-d763b03b583a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b1863f0>]}
[0m13:16:41.304813 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.stock_calcs ......................... [[32mSUCCESS 1[0m in 0.84s]
[0m13:16:41.305832 [debug] [Thread-1 (]: Finished running node model.build_ELT.stock_calcs
[0m13:16:41.307443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:41.307934 [debug] [MainThread]: Connection 'model.build_ELT.stock_calcs' was properly closed.
[0m13:16:41.308290 [info ] [MainThread]: 
[0m13:16:41.308478 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m13:16:41.309075 [debug] [MainThread]: Command end result
[0m13:16:41.326667 [info ] [MainThread]: 
[0m13:16:41.327076 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:41.327303 [info ] [MainThread]: 
[0m13:16:41.327572 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:16:41.330279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.538977, "process_user_time": 2.580691, "process_kernel_time": 1.411606, "process_mem_max_rss": "186138624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:16:41.330741 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:41.330682 after 5.54 seconds
[0m13:16:41.330990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109365400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109058950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de43b0>]}
[0m13:16:41.331234 [debug] [MainThread]: Flushing usage events
[0m13:26:20.807233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac71670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac71250>]}


============================== 13:26:20.813018 | 8d060703-05de-4013-bbf6-681b817f02dc ==============================
[0m13:26:20.813018 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:26:20.813579 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'introspect': 'True', 'partial_parse': 'True', 'version_check': 'True', 'printer_width': '80', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'static_parser': 'True', 'debug': 'False', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True'}
[0m13:26:22.238168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d060703-05de-4013-bbf6-681b817f02dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a38c5c0>]}
[0m13:26:22.264365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d060703-05de-4013-bbf6-681b817f02dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afae930>]}
[0m13:26:22.265174 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:26:22.334762 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:26:22.573347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:22.573730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:22.577074 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m13:26:22.604701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d060703-05de-4013-bbf6-681b817f02dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274a8620>]}
[0m13:26:22.699495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d060703-05de-4013-bbf6-681b817f02dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac3ab40>]}
[0m13:26:22.699917 [info ] [MainThread]: Found 2 models, 1 snapshot, 5 data tests, 1 source, 459 macros
[0m13:26:22.700110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d060703-05de-4013-bbf6-681b817f02dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271c8470>]}
[0m13:26:22.701230 [info ] [MainThread]: 
[0m13:26:22.701660 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:26:22.702192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m13:26:22.710690 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m13:26:22.711028 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m13:26:22.711215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:23.286988 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.575 seconds
[0m13:26:23.290876 [debug] [ThreadPool]: On list_stock_db: Close
[0m13:26:23.421613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now create_stock_db_snapshot)
[0m13:26:23.426075 [debug] [ThreadPool]: Creating schema "database: "stock_db"
schema: "snapshot"
"
[0m13:26:23.437260 [debug] [ThreadPool]: Using snowflake connection "create_stock_db_snapshot"
[0m13:26:23.437826 [debug] [ThreadPool]: On create_stock_db_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "create_stock_db_snapshot"} */
create schema if not exists stock_db.snapshot
[0m13:26:23.438437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:23.939770 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.501 seconds
[0m13:26:23.942195 [debug] [ThreadPool]: On create_stock_db_snapshot: Close
[0m13:26:24.097299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_stock_db_snapshot, now list_stock_db_snapshot)
[0m13:26:24.102567 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_snapshot"
[0m13:26:24.102757 [debug] [ThreadPool]: On list_stock_db_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_snapshot"} */
show objects in stock_db.snapshot limit 10000
[0m13:26:24.102905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:24.478642 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.375 seconds
[0m13:26:24.482182 [debug] [ThreadPool]: On list_stock_db_snapshot: Close
[0m13:26:24.611709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db_snapshot, now list_stock_db_analytics)
[0m13:26:24.615408 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m13:26:24.617685 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m13:26:24.617870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:25.124004 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.506 seconds
[0m13:26:25.127367 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m13:26:25.259778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d060703-05de-4013-bbf6-681b817f02dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271297c0>]}
[0m13:26:25.260816 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:26:25.261313 [info ] [MainThread]: 
[0m13:26:25.264343 [debug] [Thread-1 (]: Began running node snapshot.build_ELT.snapshot_stock_calcs
[0m13:26:25.264729 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_stock_calcs ............................ [RUN]
[0m13:26:25.264993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now snapshot.build_ELT.snapshot_stock_calcs)
[0m13:26:25.265165 [debug] [Thread-1 (]: Began compiling node snapshot.build_ELT.snapshot_stock_calcs
[0m13:26:25.269614 [debug] [Thread-1 (]: Began executing node snapshot.build_ELT.snapshot_stock_calcs
[0m13:26:25.308209 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_ELT.snapshot_stock_calcs"
[0m13:26:25.308507 [debug] [Thread-1 (]: On snapshot.build_ELT.snapshot_stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "snapshot.build_ELT.snapshot_stock_calcs"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "snapshot.build_ELT.snapshot_stock_calcs"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol, date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT 
    "date",
    "symbol",
    moving_avg_7d,
    rsi_14d
FROM stock_db.analytics.stock_calcs

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m13:26:25.308689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:25.793909 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85fa6-0004-2f4f-0002-1feb0004a83e
[0m13:26:25.794317 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 32 unexpected ','.
syntax error line 6 at position 39 unexpected 'as'.
syntax error line 6 at position 55 unexpected ')'.
[0m13:26:25.794626 [debug] [Thread-1 (]: On snapshot.build_ELT.snapshot_stock_calcs: Close
[0m13:26:25.917566 [debug] [Thread-1 (]: Database Error in snapshot snapshot_stock_calcs (snapshots/snap_calcs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 32 unexpected ','.
  syntax error line 6 at position 39 unexpected 'as'.
  syntax error line 6 at position 55 unexpected ')'.
[0m13:26:25.918597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d060703-05de-4013-bbf6-681b817f02dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16412e360>]}
[0m13:26:25.919076 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_stock_calcs ........................ [[31mERROR[0m in 0.65s]
[0m13:26:25.919483 [debug] [Thread-1 (]: Finished running node snapshot.build_ELT.snapshot_stock_calcs
[0m13:26:25.921595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:25.921761 [debug] [MainThread]: Connection 'snapshot.build_ELT.snapshot_stock_calcs' was properly closed.
[0m13:26:25.921913 [info ] [MainThread]: 
[0m13:26:25.922075 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m13:26:25.922457 [debug] [MainThread]: Command end result
[0m13:26:25.942644 [info ] [MainThread]: 
[0m13:26:25.942988 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:26:25.943192 [info ] [MainThread]: 
[0m13:26:25.943403 [error] [MainThread]:   Database Error in snapshot snapshot_stock_calcs (snapshots/snap_calcs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 32 unexpected ','.
  syntax error line 6 at position 39 unexpected 'as'.
  syntax error line 6 at position 55 unexpected ')'.
[0m13:26:25.943596 [info ] [MainThread]: 
[0m13:26:25.943793 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:26:25.946715 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 5.2007513, "process_user_time": 3.344519, "process_kernel_time": 0.996111, "process_mem_max_rss": "185057280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:26:25.947191 [debug] [MainThread]: Command `dbt snapshot` failed at 13:26:25.947129 after 5.20 seconds
[0m13:26:25.947427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac715b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2db8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271ca4b0>]}
[0m13:26:25.947625 [debug] [MainThread]: Flushing usage events
[0m13:29:38.824683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103af3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105611550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058dd1f0>]}


============================== 13:29:38.828538 | e784b958-25ac-4ade-a77c-73bfcdc55d1e ==============================
[0m13:29:38.828538 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:29:38.828953 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_format': 'default', 'partial_parse': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'warn_error': 'None', 'version_check': 'True', 'use_experimental_parser': 'False'}
[0m13:29:40.183027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e784b958-25ac-4ade-a77c-73bfcdc55d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12713e600>]}
[0m13:29:40.210956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e784b958-25ac-4ade-a77c-73bfcdc55d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040d59a0>]}
[0m13:29:40.211760 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:29:40.280877 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:29:40.382960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:29:40.383383 [debug] [MainThread]: Partial parsing: updated file: build_ELT://snapshots/snap_calcs.sql
[0m13:29:40.444649 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_stock_calcs (snapshots/snap_calcs.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m13:29:40.446846 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.6662036, "process_user_time": 2.61565, "process_kernel_time": 1.155615, "process_mem_max_rss": "186564608", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:29:40.447204 [debug] [MainThread]: Command `dbt snapshot` failed at 13:29:40.447145 after 1.67 seconds
[0m13:29:40.447431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058dd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1351b2060>]}
[0m13:29:40.447628 [debug] [MainThread]: Flushing usage events
[0m13:38:04.514347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105615370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb9250>]}


============================== 13:38:04.518320 | 5209f425-2795-4b3e-8ca4-7687bd617ef6 ==============================
[0m13:38:04.518320 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:38:04.518667 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'warn_error': 'None', 'invocation_command': 'dbt snapshot', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'quiet': 'False', 'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'log_format': 'default', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'no_print': 'None', 'fail_fast': 'False', 'write_json': 'True', 'indirect_selection': 'eager'}
[0m13:38:05.933444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5209f425-2795-4b3e-8ca4-7687bd617ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe89430>]}
[0m13:38:05.960960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5209f425-2795-4b3e-8ca4-7687bd617ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207782f0>]}
[0m13:38:05.961739 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:38:06.031131 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:38:06.141840 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m13:38:06.142335 [debug] [MainThread]: Partial parsing: added file: build_ELT://snapshots/snapshot_stock_calcs.sql
[0m13:38:06.142512 [debug] [MainThread]: Partial parsing: deleted file: build_ELT://snapshots/snap_calcs.sql
[0m13:38:06.201787 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_stock_calcs (snapshots/snapshot_stock_calcs.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m13:38:06.204395 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.734924, "process_user_time": 2.37476, "process_kernel_time": 1.475665, "process_mem_max_rss": "185106432", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:38:06.204779 [debug] [MainThread]: Command `dbt snapshot` failed at 13:38:06.204722 after 1.74 seconds
[0m13:38:06.205006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b8abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120722f90>]}
[0m13:38:06.205201 [debug] [MainThread]: Flushing usage events
[0m13:38:31.516177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106461970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f39610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f391f0>]}


============================== 13:38:31.521703 | a4a5cc05-5888-44aa-aaf4-aaad36af89db ==============================
[0m13:38:31.521703 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:38:31.522065 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'introspect': 'True', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'empty': 'None', 'no_print': 'None', 'write_json': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'debug': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt snapshot', 'target_path': 'None'}
[0m13:38:32.200670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4a5cc05-5888-44aa-aaf4-aaad36af89db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105731610>]}
[0m13:38:32.227357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4a5cc05-5888-44aa-aaf4-aaad36af89db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e3a6ea0>]}
[0m13:38:32.228177 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:38:32.295272 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:38:32.448449 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m13:38:32.448874 [debug] [MainThread]: Partial parsing: added file: build_ELT://snapshots/snapshot_stock_calcs.sql
[0m13:38:32.449040 [debug] [MainThread]: Partial parsing: deleted file: build_ELT://snapshots/snap_calcs.sql
[0m13:38:32.529632 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_stock_calcs (snapshots/snapshot_stock_calcs.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m13:38:32.531452 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0517771, "process_user_time": 2.011879, "process_kernel_time": 1.196106, "process_mem_max_rss": "187531264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:38:32.531892 [debug] [MainThread]: Command `dbt snapshot` failed at 13:38:32.531822 after 1.05 seconds
[0m13:38:32.532132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f39370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa3d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd01130>]}
[0m13:38:32.532338 [debug] [MainThread]: Flushing usage events
[0m13:42:20.051804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ad6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ad2e0>]}


============================== 13:42:20.056424 | 00cf47e4-c0fd-4204-9093-3db4db150f48 ==============================
[0m13:42:20.056424 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:42:20.056776 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'static_parser': 'True', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt snapshot', 'version_check': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'empty': 'None'}
[0m13:42:21.263964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00cf47e4-c0fd-4204-9093-3db4db150f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cbd5e20>]}
[0m13:42:21.288636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00cf47e4-c0fd-4204-9093-3db4db150f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c7d28d0>]}
[0m13:42:21.289305 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:42:21.365897 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:42:21.475830 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m13:42:21.476275 [debug] [MainThread]: Partial parsing: added file: build_ELT://snapshots/snapshot_stock_calcs.sql
[0m13:42:21.476451 [debug] [MainThread]: Partial parsing: deleted file: build_ELT://snapshots/snap_calcs.sql
[0m13:42:21.545595 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_stock_calcs (snapshots/snapshot_stock_calcs.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m13:42:21.548120 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.5446057, "process_user_time": 2.169328, "process_kernel_time": 1.447929, "process_mem_max_rss": "186368000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:42:21.548549 [debug] [MainThread]: Command `dbt snapshot` failed at 13:42:21.548489 after 1.55 seconds
[0m13:42:21.548807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ad6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ddb2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e0dfc50>]}
[0m13:42:21.549044 [debug] [MainThread]: Flushing usage events
[0m13:46:14.038476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10457f1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f695e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f691c0>]}


============================== 13:46:14.041844 | abde2888-a6fb-422e-b2c3-e8b45314762f ==============================
[0m13:46:14.041844 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:46:14.042218 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt snapshot', 'write_json': 'True', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'debug': 'False', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'static_parser': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m13:46:15.322920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abde2888-a6fb-422e-b2c3-e8b45314762f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126202630>]}
[0m13:46:15.349910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abde2888-a6fb-422e-b2c3-e8b45314762f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1266c17f0>]}
[0m13:46:15.350666 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:46:15.430865 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:46:15.536384 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m13:46:15.536815 [debug] [MainThread]: Partial parsing: added file: build_ELT://snapshots/snapshot_stock_calcs.sql
[0m13:46:15.536990 [debug] [MainThread]: Partial parsing: deleted file: build_ELT://snapshots/snap_calcs.sql
[0m13:46:15.601192 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_stock_calcs (snapshots/snapshot_stock_calcs.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m13:46:15.603854 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.6080705, "process_user_time": 2.635406, "process_kernel_time": 1.053259, "process_mem_max_rss": "187891712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:46:15.604322 [debug] [MainThread]: Command `dbt snapshot` failed at 13:46:15.604258 after 1.61 seconds
[0m13:46:15.604579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f692e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1267e6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1267e5e50>]}
[0m13:46:15.604806 [debug] [MainThread]: Flushing usage events
[0m13:47:38.030672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cad5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cad190>]}


============================== 13:47:38.033788 | 6c7921ba-96bc-4767-9ee6-a660565688d5 ==============================
[0m13:47:38.033788 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:47:38.034169 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt snapshot', 'write_json': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'no_print': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'partial_parse': 'True'}
[0m13:47:38.972004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c7921ba-96bc-4767-9ee6-a660565688d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c47560>]}
[0m13:47:38.996499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c7921ba-96bc-4767-9ee6-a660565688d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459de600>]}
[0m13:47:38.997126 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:47:39.062936 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:47:39.160540 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m13:47:39.160885 [debug] [MainThread]: Partial parsing: added file: build_ELT://snapshots/snapshot_stock_calcs.sql
[0m13:47:39.161045 [debug] [MainThread]: Partial parsing: deleted file: build_ELT://snapshots/snap_calcs.sql
[0m13:47:39.282814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m13:47:39.288935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c7921ba-96bc-4767-9ee6-a660565688d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1463f9c70>]}
[0m13:47:39.348461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c7921ba-96bc-4767-9ee6-a660565688d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1463f96d0>]}
[0m13:47:39.348777 [info ] [MainThread]: Found 2 models, 5 data tests, 1 snapshot, 1 source, 459 macros
[0m13:47:39.348954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c7921ba-96bc-4767-9ee6-a660565688d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460aff50>]}
[0m13:47:39.349861 [info ] [MainThread]: 
[0m13:47:39.350164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:39.350696 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m13:47:39.357299 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m13:47:39.357487 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m13:47:39.357631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:39.974529 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.617 seconds
[0m13:47:39.978306 [debug] [ThreadPool]: On list_stock_db: Close
[0m13:47:40.118174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics)
[0m13:47:40.123164 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m13:47:40.123412 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m13:47:40.123561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:40.673008 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.549 seconds
[0m13:47:40.676712 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m13:47:40.816632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now list_stock_db_snapshot)
[0m13:47:40.822215 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_snapshot"
[0m13:47:40.822507 [debug] [ThreadPool]: On list_stock_db_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_snapshot"} */
show objects in stock_db.snapshot limit 10000
[0m13:47:40.822655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:41.209927 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.387 seconds
[0m13:47:41.213379 [debug] [ThreadPool]: On list_stock_db_snapshot: Close
[0m13:47:41.346554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c7921ba-96bc-4767-9ee6-a660565688d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1463f64e0>]}
[0m13:47:41.347660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:47:41.348339 [info ] [MainThread]: 
[0m13:47:41.352189 [debug] [Thread-1 (]: Began running node snapshot.build_ELT.snapshot_stock_calcs
[0m13:47:41.353027 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_stock_calcs ............................ [RUN]
[0m13:47:41.353457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_snapshot, now snapshot.build_ELT.snapshot_stock_calcs)
[0m13:47:41.353665 [debug] [Thread-1 (]: Began compiling node snapshot.build_ELT.snapshot_stock_calcs
[0m13:47:41.357981 [debug] [Thread-1 (]: Began executing node snapshot.build_ELT.snapshot_stock_calcs
[0m13:47:41.401421 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_ELT.snapshot_stock_calcs"
[0m13:47:41.401737 [debug] [Thread-1 (]: On snapshot.build_ELT.snapshot_stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "snapshot.build_ELT.snapshot_stock_calcs"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "snapshot.build_ELT.snapshot_stock_calcs"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT 
    "date",
    "symbol",
    moving_avg_7d,
    rsi_14d
FROM stock_db.analytics.stock_calcs

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m13:47:41.401925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:41.795774 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85fbb-0004-2f06-0002-1feb0004982a
[0m13:47:41.796067 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 4
invalid identifier '"date"'
[0m13:47:41.796337 [debug] [Thread-1 (]: On snapshot.build_ELT.snapshot_stock_calcs: Close
[0m13:47:41.926029 [debug] [Thread-1 (]: Database Error in snapshot snapshot_stock_calcs (snapshots/snapshot_stock_calcs.sql)
  000904 (42000): SQL compilation error: error line 22 at position 4
  invalid identifier '"date"'
[0m13:47:41.927096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c7921ba-96bc-4767-9ee6-a660565688d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3d7c0>]}
[0m13:47:41.927539 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_stock_calcs ........................ [[31mERROR[0m in 0.57s]
[0m13:47:41.927867 [debug] [Thread-1 (]: Finished running node snapshot.build_ELT.snapshot_stock_calcs
[0m13:47:41.928892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:41.929079 [debug] [MainThread]: Connection 'snapshot.build_ELT.snapshot_stock_calcs' was properly closed.
[0m13:47:41.929228 [info ] [MainThread]: 
[0m13:47:41.929387 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m13:47:41.929687 [debug] [MainThread]: Command end result
[0m13:47:41.946038 [info ] [MainThread]: 
[0m13:47:41.946289 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:47:41.946443 [info ] [MainThread]: 
[0m13:47:41.946621 [error] [MainThread]:   Database Error in snapshot snapshot_stock_calcs (snapshots/snapshot_stock_calcs.sql)
  000904 (42000): SQL compilation error: error line 22 at position 4
  invalid identifier '"date"'
[0m13:47:41.946765 [info ] [MainThread]: 
[0m13:47:41.946914 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:47:41.948336 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.957434, "process_user_time": 2.814375, "process_kernel_time": 0.862303, "process_mem_max_rss": "196231168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:47:41.948623 [debug] [MainThread]: Command `dbt snapshot` failed at 13:47:41.948581 after 3.96 seconds
[0m13:47:41.948818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e68590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145f55940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146771df0>]}
[0m13:47:41.948988 [debug] [MainThread]: Flushing usage events
[0m13:49:34.315244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e27050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f51f0>]}


============================== 13:49:34.318735 | e45eb325-4f1d-4fcf-a03a-c42b466bf20c ==============================
[0m13:49:34.318735 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:49:34.319097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'no_print': 'None', 'static_parser': 'True', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'debug': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt snapshot', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'empty': 'None'}
[0m13:49:35.361937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e45eb325-4f1d-4fcf-a03a-c42b466bf20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12124ffb0>]}
[0m13:49:35.388196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e45eb325-4f1d-4fcf-a03a-c42b466bf20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213c9310>]}
[0m13:49:35.388905 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:49:35.456004 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:49:35.559483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:49:35.559922 [debug] [MainThread]: Partial parsing: updated file: build_ELT://snapshots/snapshot_stock_calcs.sql
[0m13:49:35.618268 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_stock_calcs (snapshots/snapshot_stock_calcs.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m13:49:35.619884 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.3653178, "process_user_time": 2.239265, "process_kernel_time": 1.227684, "process_mem_max_rss": "187498496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:49:35.620227 [debug] [MainThread]: Command `dbt snapshot` failed at 13:49:35.620174 after 1.37 seconds
[0m13:49:35.620436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12153d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d91f9b0>]}
[0m13:49:35.620620 [debug] [MainThread]: Flushing usage events
[0m13:49:48.420751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097e13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d71580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d71160>]}


============================== 13:49:48.426859 | 2976b6c9-e969-4037-8e8e-4011adab8bfa ==============================
[0m13:49:48.426859 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:49:48.427836 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'debug': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'target_path': 'None', 'printer_width': '80', 'introspect': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'static_parser': 'True'}
[0m13:49:49.194367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2976b6c9-e969-4037-8e8e-4011adab8bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb32060>]}
[0m13:49:49.219341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2976b6c9-e969-4037-8e8e-4011adab8bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e7b60>]}
[0m13:49:49.220010 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:49:49.285828 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:49:49.381565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:49:49.381841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:49:49.384531 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m13:49:49.407049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2976b6c9-e969-4037-8e8e-4011adab8bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ffa19d0>]}
[0m13:49:49.468790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2976b6c9-e969-4037-8e8e-4011adab8bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d3c4410>]}
[0m13:49:49.469114 [info ] [MainThread]: Found 2 models, 5 data tests, 1 snapshot, 1 source, 459 macros
[0m13:49:49.469310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2976b6c9-e969-4037-8e8e-4011adab8bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff07ad0>]}
[0m13:49:49.470231 [info ] [MainThread]: 
[0m13:49:49.470542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:49:49.470972 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m13:49:49.478380 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m13:49:49.478568 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m13:49:49.478714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:50.015560 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.536 seconds
[0m13:49:50.018904 [debug] [ThreadPool]: On list_stock_db: Close
[0m13:49:50.166986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics)
[0m13:49:50.172218 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m13:49:50.172420 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m13:49:50.172576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:50.557537 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.385 seconds
[0m13:49:50.560027 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m13:49:50.697328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now list_stock_db_snapshot)
[0m13:49:50.702765 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_snapshot"
[0m13:49:50.703043 [debug] [ThreadPool]: On list_stock_db_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_snapshot"} */
show objects in stock_db.snapshot limit 10000
[0m13:49:50.703188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:51.158187 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.455 seconds
[0m13:49:51.161059 [debug] [ThreadPool]: On list_stock_db_snapshot: Close
[0m13:49:51.281065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2976b6c9-e969-4037-8e8e-4011adab8bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d47d820>]}
[0m13:49:51.282251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:51.282773 [info ] [MainThread]: 
[0m13:49:51.286484 [debug] [Thread-1 (]: Began running node snapshot.build_ELT.snapshot_stock_calcs
[0m13:49:51.287410 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_stock_calcs ............................ [RUN]
[0m13:49:51.288096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_snapshot, now snapshot.build_ELT.snapshot_stock_calcs)
[0m13:49:51.288427 [debug] [Thread-1 (]: Began compiling node snapshot.build_ELT.snapshot_stock_calcs
[0m13:49:51.293381 [debug] [Thread-1 (]: Began executing node snapshot.build_ELT.snapshot_stock_calcs
[0m13:49:51.345175 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_ELT.snapshot_stock_calcs"
[0m13:49:51.346551 [debug] [Thread-1 (]: On snapshot.build_ELT.snapshot_stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "snapshot.build_ELT.snapshot_stock_calcs"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "snapshot.build_ELT.snapshot_stock_calcs"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT 
    "date",
    "symbol",
    moving_avg_7d,
    rsi_14d
FROM stock_db.analytics.stock_calcs

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m13:49:51.346833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:51.764608 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85fbd-0004-2f06-0002-1feb00049832
[0m13:49:51.764908 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 4
invalid identifier '"date"'
[0m13:49:51.765164 [debug] [Thread-1 (]: On snapshot.build_ELT.snapshot_stock_calcs: Close
[0m13:49:51.886051 [debug] [Thread-1 (]: Database Error in snapshot snapshot_stock_calcs (snapshots/snapshot_stock_calcs.sql)
  000904 (42000): SQL compilation error: error line 22 at position 4
  invalid identifier '"date"'
[0m13:49:51.887064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2976b6c9-e969-4037-8e8e-4011adab8bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d5537a0>]}
[0m13:49:51.887549 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_stock_calcs ........................ [[31mERROR[0m in 0.60s]
[0m13:49:51.887883 [debug] [Thread-1 (]: Finished running node snapshot.build_ELT.snapshot_stock_calcs
[0m13:49:51.889232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:51.889407 [debug] [MainThread]: Connection 'snapshot.build_ELT.snapshot_stock_calcs' was properly closed.
[0m13:49:51.889567 [info ] [MainThread]: 
[0m13:49:51.889729 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m13:49:51.890040 [debug] [MainThread]: Command end result
[0m13:49:51.910739 [info ] [MainThread]: 
[0m13:49:51.911033 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:49:51.911197 [info ] [MainThread]: 
[0m13:49:51.911393 [error] [MainThread]:   Database Error in snapshot snapshot_stock_calcs (snapshots/snapshot_stock_calcs.sql)
  000904 (42000): SQL compilation error: error line 22 at position 4
  invalid identifier '"date"'
[0m13:49:51.911539 [info ] [MainThread]: 
[0m13:49:51.911699 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:49:51.913277 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.5711641, "process_user_time": 2.839851, "process_kernel_time": 0.583521, "process_mem_max_rss": "186482688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:49:51.913635 [debug] [MainThread]: Command `dbt snapshot` failed at 13:49:51.913585 after 3.57 seconds
[0m13:49:51.913911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109510290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d71550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d71490>]}
[0m13:49:51.914153 [debug] [MainThread]: Flushing usage events
[0m13:52:05.560932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105035610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050351f0>]}


============================== 13:52:05.564246 | d7fc3132-dc35-4471-824b-aa3602f25590 ==============================
[0m13:52:05.564246 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:52:05.564620 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'use_colors': 'True', 'static_parser': 'True', 'quiet': 'False', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'target_path': 'None', 'empty': 'None', 'version_check': 'True', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT'}
[0m13:52:06.484881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7fc3132-dc35-4471-824b-aa3602f25590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10382d880>]}
[0m13:52:06.514234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7fc3132-dc35-4471-824b-aa3602f25590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff9e20>]}
[0m13:52:06.515098 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:52:06.586304 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:52:06.685915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:52:06.686315 [debug] [MainThread]: Partial parsing: updated file: build_ELT://snapshots/snapshot_stock_calcs.sql
[0m13:52:06.744569 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_stock_calcs (snapshots/snapshot_stock_calcs.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m13:52:06.746193 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.2233435, "process_user_time": 2.164959, "process_kernel_time": 0.983463, "process_mem_max_rss": "181960704", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:52:06.746508 [debug] [MainThread]: Command `dbt snapshot` failed at 13:52:06.746457 after 1.22 seconds
[0m13:52:06.746714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050355b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1292fffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f420bf0>]}
[0m13:52:06.746897 [debug] [MainThread]: Flushing usage events
[0m13:52:58.115979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104949580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104949190>]}


============================== 13:52:58.119533 | 269e06f4-814f-4ebb-98b2-ad7508f91772 ==============================
[0m13:52:58.119533 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:52:58.119931 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_format': 'default', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'no_print': 'None', 'write_json': 'True', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True'}
[0m13:52:59.083888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '269e06f4-814f-4ebb-98b2-ad7508f91772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128ca7fb0>]}
[0m13:52:59.108643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '269e06f4-814f-4ebb-98b2-ad7508f91772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e001310>]}
[0m13:52:59.109434 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:52:59.176780 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:52:59.276460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:52:59.276861 [debug] [MainThread]: Partial parsing: updated file: build_ELT://snapshots/snapshot_stock_calcs.sql
[0m13:52:59.336893 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_stock_calcs (snapshots/snapshot_stock_calcs.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m13:52:59.338563 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.2623973, "process_user_time": 2.424425, "process_kernel_time": 0.773643, "process_mem_max_rss": "185008128", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:52:59.338889 [debug] [MainThread]: Command `dbt snapshot` failed at 13:52:59.338837 after 1.26 seconds
[0m13:52:59.339103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104949280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129055100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12909e810>]}
[0m13:52:59.339288 [debug] [MainThread]: Flushing usage events
[0m13:53:49.305854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107878110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dad4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dad0a0>]}


============================== 13:53:49.309315 | a89aeb8e-e593-45c4-9474-066789fc4f05 ==============================
[0m13:53:49.309315 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:53:49.309707 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'introspect': 'True', 'empty': 'None', 'log_path': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt snapshot', 'quiet': 'False', 'printer_width': '80', 'static_parser': 'True', 'profiles_dir': '/Users/himajasree/Desktop/dw_lab2/week10/build_ELT', 'write_json': 'True', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m13:53:50.247824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a89aeb8e-e593-45c4-9474-066789fc4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135de9700>]}
[0m13:53:50.276122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a89aeb8e-e593-45c4-9474-066789fc4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dc17f0>]}
[0m13:53:50.276945 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:53:50.351749 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:53:50.456509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:53:50.456937 [debug] [MainThread]: Partial parsing: updated file: build_ELT://snapshots/snapshot_stock_calcs.sql
[0m13:53:50.585544 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_ELT.stock_metrics
[0m13:53:50.591879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a89aeb8e-e593-45c4-9474-066789fc4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d999a0>]}
[0m13:53:50.667084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a89aeb8e-e593-45c4-9474-066789fc4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136db99d0>]}
[0m13:53:50.667411 [info ] [MainThread]: Found 2 models, 5 data tests, 1 snapshot, 1 source, 459 macros
[0m13:53:50.667591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a89aeb8e-e593-45c4-9474-066789fc4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136de17f0>]}
[0m13:53:50.668557 [info ] [MainThread]: 
[0m13:53:50.668910 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:53:50.669486 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_stock_db'
[0m13:53:50.676357 [debug] [ThreadPool]: Using snowflake connection "list_stock_db"
[0m13:53:50.676600 [debug] [ThreadPool]: On list_stock_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db"} */
show terse schemas in database stock_db
    limit 10000
[0m13:53:50.676747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:51.281073 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.604 seconds
[0m13:53:51.285226 [debug] [ThreadPool]: On list_stock_db: Close
[0m13:53:51.414486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db, now list_stock_db_analytics)
[0m13:53:51.421353 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_analytics"
[0m13:53:51.421687 [debug] [ThreadPool]: On list_stock_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_analytics"} */
show objects in stock_db.analytics limit 10000
[0m13:53:51.421860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:51.818199 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.396 seconds
[0m13:53:51.821727 [debug] [ThreadPool]: On list_stock_db_analytics: Close
[0m13:53:51.941753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stock_db_analytics, now list_stock_db_snapshot)
[0m13:53:51.946075 [debug] [ThreadPool]: Using snowflake connection "list_stock_db_snapshot"
[0m13:53:51.946481 [debug] [ThreadPool]: On list_stock_db_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "connection_name": "list_stock_db_snapshot"} */
show objects in stock_db.snapshot limit 10000
[0m13:53:51.946664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:52.417131 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.470 seconds
[0m13:53:52.420301 [debug] [ThreadPool]: On list_stock_db_snapshot: Close
[0m13:53:52.549498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a89aeb8e-e593-45c4-9474-066789fc4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136de8890>]}
[0m13:53:52.550697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:52.551286 [info ] [MainThread]: 
[0m13:53:52.554855 [debug] [Thread-1 (]: Began running node snapshot.build_ELT.snapshot_stock_calcs
[0m13:53:52.555301 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_stock_calcs ............................ [RUN]
[0m13:53:52.555573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stock_db_snapshot, now snapshot.build_ELT.snapshot_stock_calcs)
[0m13:53:52.555752 [debug] [Thread-1 (]: Began compiling node snapshot.build_ELT.snapshot_stock_calcs
[0m13:53:52.560172 [debug] [Thread-1 (]: Began executing node snapshot.build_ELT.snapshot_stock_calcs
[0m13:53:52.603089 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_ELT.snapshot_stock_calcs"
[0m13:53:52.603408 [debug] [Thread-1 (]: On snapshot.build_ELT.snapshot_stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "snapshot.build_ELT.snapshot_stock_calcs"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "snapshot.build_ELT.snapshot_stock_calcs"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(DATE as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT 
    DATE,
    SYMBOL,
    MOVING_AVG_7D,
    RSI_14D
FROM stock_db.analytics.stock_calcs

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m13:53:52.603599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:53.509759 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.906 seconds
[0m13:53:53.516353 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_ELT.snapshot_stock_calcs"
[0m13:53:53.516724 [debug] [Thread-1 (]: On snapshot.build_ELT.snapshot_stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "snapshot.build_ELT.snapshot_stock_calcs"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "snapshot.build_ELT.snapshot_stock_calcs"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m13:53:53.598926 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.082 seconds
[0m13:53:53.601782 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.build_ELT.snapshot_stock_calcs"
[0m13:53:53.605032 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_ELT.snapshot_stock_calcs"
[0m13:53:53.605798 [debug] [Thread-1 (]: On snapshot.build_ELT.snapshot_stock_calcs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_ELT", "target_name": "dev", "node_id": "snapshot.build_ELT.snapshot_stock_calcs"} */
create or replace transient table stock_db.snapshot.snapshot_stock_calcs
         as
        (
    

    select *,
        md5(coalesce(cast(DATE as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT 
    DATE,
    SYMBOL,
    MOVING_AVG_7D,
    RSI_14D
FROM stock_db.analytics.stock_calcs

    ) sbq



        );
[0m13:53:54.943000 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.336 seconds
[0m13:53:54.960536 [debug] [Thread-1 (]: On snapshot.build_ELT.snapshot_stock_calcs: Close
[0m13:53:55.084189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89aeb8e-e593-45c4-9474-066789fc4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11113d9a0>]}
[0m13:53:55.085818 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_stock_calcs ............................ [[32mSUCCESS 1[0m in 2.53s]
[0m13:53:55.087017 [debug] [Thread-1 (]: Finished running node snapshot.build_ELT.snapshot_stock_calcs
[0m13:53:55.088388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:55.088616 [debug] [MainThread]: Connection 'snapshot.build_ELT.snapshot_stock_calcs' was properly closed.
[0m13:53:55.088805 [info ] [MainThread]: 
[0m13:53:55.088982 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.42 seconds (4.42s).
[0m13:53:55.089457 [debug] [MainThread]: Command end result
[0m13:53:55.110150 [info ] [MainThread]: 
[0m13:53:55.110935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:53:55.111108 [info ] [MainThread]: 
[0m13:53:55.111309 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:53:55.113917 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.8468447, "process_user_time": 2.47151, "process_kernel_time": 1.328602, "process_mem_max_rss": "189513728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:53:55.114320 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:53:55.114268 after 5.85 seconds
[0m13:53:55.114551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dad400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136e06e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111710140>]}
[0m13:53:55.114725 [debug] [MainThread]: Flushing usage events
[0m02:21:14.818300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86be91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d2e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86be8bc0>]}


============================== 02:21:14.848356 | 61e19516-b8cf-4b2e-a0be-ded40657e4cb ==============================
[0m02:21:14.848356 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:21:14.849378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/build_ELT', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/build_ELT/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:21:14.921882 [info ] [MainThread]: dbt version: 1.8.7
[0m02:21:14.923200 [info ] [MainThread]: python version: 3.12.3
[0m02:21:14.924844 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m02:21:14.925950 [info ] [MainThread]: os info: Linux-6.10.4-linuxkit-aarch64-with-glibc2.36
[0m02:21:17.139987 [info ] [MainThread]: Using profiles dir at /opt/airflow/build_ELT
[0m02:21:17.145953 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/build_ELT/profiles.yml
[0m02:21:17.153606 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/build_ELT/dbt_project.yml
[0m02:21:17.158479 [info ] [MainThread]: adapter type: snowflake
[0m02:21:17.159206 [info ] [MainThread]: adapter version: 1.8.4
[0m02:21:17.314932 [info ] [MainThread]: Configuration:
[0m02:21:17.317731 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:21:17.318423 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:21:17.319314 [info ] [MainThread]: Required dependencies:
[0m02:21:17.323830 [debug] [MainThread]: Executing "git --help"
[0m02:21:17.362048 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m02:21:17.365109 [info ] [MainThread]: Connection:
[0m02:21:17.365846 [info ] [MainThread]:   account: RRWXRUI-RNB26847
[0m02:21:17.366838 [info ] [MainThread]:   user: himajasree83
[0m02:21:17.367843 [info ] [MainThread]:   database: stock_db
[0m02:21:17.368975 [info ] [MainThread]:   warehouse: compute_wh
[0m02:21:17.369424 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m02:21:17.370557 [info ] [MainThread]:   schema: analytics
[0m02:21:17.371030 [info ] [MainThread]:   authenticator: None
[0m02:21:17.371604 [info ] [MainThread]:   oauth_client_id: None
[0m02:21:17.372264 [info ] [MainThread]:   query_tag: None
[0m02:21:17.373879 [info ] [MainThread]:   client_session_keep_alive: False
[0m02:21:17.375717 [info ] [MainThread]:   host: None
[0m02:21:17.377214 [info ] [MainThread]:   port: None
[0m02:21:17.379190 [info ] [MainThread]:   proxy_host: None
[0m02:21:17.380785 [info ] [MainThread]:   proxy_port: None
[0m02:21:17.382145 [info ] [MainThread]:   protocol: None
[0m02:21:17.383005 [info ] [MainThread]:   connect_retries: 1
[0m02:21:17.384502 [info ] [MainThread]:   connect_timeout: None
[0m02:21:17.385916 [info ] [MainThread]:   retry_on_database_errors: False
[0m02:21:17.386863 [info ] [MainThread]:   retry_all: False
[0m02:21:17.387550 [info ] [MainThread]:   insecure_mode: False
[0m02:21:17.388516 [info ] [MainThread]:   reuse_connections: None
[0m02:21:17.391926 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:21:18.130654 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m02:21:18.134954 [debug] [MainThread]: Using snowflake connection "debug"
[0m02:21:18.135577 [debug] [MainThread]: On debug: select 1 as id
[0m02:21:18.136125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:21:54.786760 [debug] [MainThread]: SQL status: SUCCESS 1 in 37.031 seconds
[0m02:21:54.953945 [debug] [MainThread]: On debug: Close
[0m02:21:55.802886 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:21:55.920736 [info ] [MainThread]: [31m1 check failed:[0m
[0m02:21:56.012455 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m02:21:56.272244 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 42.18595, "process_user_time": 4.006156, "process_kernel_time": 6.424466, "process_mem_max_rss": "139476", "process_in_blocks": "4378408", "process_out_blocks": "2201", "command_success": false}
[0m02:21:56.418391 [debug] [MainThread]: Command `dbt debug` failed at 02:21:56.307430 after 42.30 seconds
[0m02:21:56.607375 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:21:56.832166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67009010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66c0f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67047da0>]}
[0m02:21:56.907226 [debug] [MainThread]: Flushing usage events
[0m02:24:14.904611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc30bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd052780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba2c0a10>]}


============================== 02:24:14.926487 | 01885420-50f9-4319-9d06-b13b47571d93 ==============================
[0m02:24:14.926487 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:24:14.927408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/build_ELT', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/build_ELT/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:24:16.224304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01885420-50f9-4319-9d06-b13b47571d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a3d00e0>]}
[0m02:24:16.258224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01885420-50f9-4319-9d06-b13b47571d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a57f800>]}
[0m02:24:16.259305 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:24:16.331854 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:24:16.430215 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m02:24:16.431010 [debug] [MainThread]: Partial parsing: deleted file: build_ELT://models/output/stock_calcs.sql
[0m02:24:16.525833 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.build_ELT.snapshot_stock_calcs' (snapshots/snapshot_stock_calcs.sql) depends on a node named 'stock_calcs' which was not found
[0m02:24:16.527886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6996326, "process_user_time": 2.788348, "process_kernel_time": 0.522052, "process_mem_max_rss": "194332", "process_in_blocks": "184696", "process_out_blocks": "4", "command_success": false}
[0m02:24:16.528522 [debug] [MainThread]: Command `dbt run` failed at 02:24:16.528423 after 1.70 seconds
[0m02:24:16.529050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaa46270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a997530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a88e5d0>]}
[0m02:24:16.529511 [debug] [MainThread]: Flushing usage events
[0m02:25:15.923728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9427a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad26c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9a775f0>]}


============================== 02:25:15.942567 | 57dca60d-4a86-4266-8e62-ec19df841caf ==============================
[0m02:25:15.942567 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:25:15.943306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/build_ELT', 'log_path': '/opt/airflow/build_ELT/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:25:16.917989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57dca60d-4a86-4266-8e62-ec19df841caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce62c30>]}
[0m02:25:16.944942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57dca60d-4a86-4266-8e62-ec19df841caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8dae4e0>]}
[0m02:25:16.945928 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:25:17.013584 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:25:17.078449 [error] [MainThread]: Encountered an error:
[Errno 35] Resource deadlock avoided
[0m02:25:17.080949 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/parser/read_files.py", line 82, in load_source_file
    file_contents = load_file_contents(path.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^
OSError: [Errno 35] Resource deadlock avoided

[0m02:25:17.082352 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2206764, "process_user_time": 2.785451, "process_kernel_time": 0.412096, "process_mem_max_rss": "192688", "process_in_blocks": "186312", "process_out_blocks": "10", "command_success": false}
[0m02:25:17.082745 [debug] [MainThread]: Command `dbt run` failed at 02:25:17.082678 after 1.22 seconds
[0m02:25:17.083026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f946b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce8edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d32dbb0>]}
[0m02:25:17.083298 [debug] [MainThread]: Flushing usage events
